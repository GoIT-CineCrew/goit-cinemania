import{c as b,o as L}from"./modal-qMZ89UAs.js";const{TMDB_API_KEY:k,TMDB_BASE_URL:v}=b;async function S(){const r=document.querySelector(".library-hero-bg");if(!r){console.log("library-hero-bg bulunamadı");return}try{const t=localStorage.getItem("myMovieLibrary");if(!t){console.log("Kütüphane yok – fallback kullanılıyor");return}const n=JSON.parse(t);if(!Array.isArray(n)||n.length===0){console.log("Kütüphane boş – fallback kullanılıyor");return}const e=n[Math.floor(Math.random()*n.length)],s=typeof e=="number"?e:e.id;if(!s){console.log("Geçerli ID yok");return}console.log("Kütüphaneden seçilen film ID:",s);const a=await fetch(`${v}/movie/${s}?api_key=${k}`);if(!a.ok){console.log("API hatası:",a.status);return}const o=await a.json(),y=o==null?void 0:o.backdrop_path;if(y){const c=`https://image.tmdb.org/t/p/w1920${y}`;r.style.backgroundImage=`url('${c}')`,r.style.backgroundSize="cover",r.style.backgroundPosition="center",r.style.backgroundRepeat="no-repeat",console.log("Library hero yüklendi:",o.title)}else console.log("Backdrop yok:",o.title)}catch(t){console.error("Library hero görseli yüklenemedi:",t)}}S();const g={},I="aaf24ac7ab7c5211361a71263e777bb9";let p=null;const i=document.querySelector(".library-dropdown-filter"),m=i.querySelector(".selected"),l=i.querySelector(".options");m.addEventListener("click",()=>{const r=i.classList.toggle("open");l.style.display=r?"block":"none"});document.addEventListener("click",r=>{i.contains(r.target)||(i.classList.remove("open"),l.style.display="none")});async function A(){const r=localStorage.getItem("tmdbGenresIdToName");if(r){Object.assign(g,JSON.parse(r));return}try{const t=await axios.get("https://api.themoviedb.org/3/genre/movie/list",{params:{api_key:I,language:"en-US"}}),n={};t.data.genres.forEach(e=>{n[e.id]=e.name}),Object.assign(g,n),localStorage.setItem("tmdbGenresIdToName",JSON.stringify(n))}catch(t){console.error("Türler yüklenemedi:",t)}}function E(){const r=localStorage.getItem("myMovieLibrary");if(!r)return[];const t=JSON.parse(r),n=new Set;return t.forEach(e=>{let s=[];Array.isArray(e.genre_ids)?s=e.genre_ids:Array.isArray(e.genres)&&(s=e.genres.map(a=>a.id)),s.forEach(a=>{g[a]&&n.add(a)})}),Array.from(n)}function M(){const r=E();l.innerHTML="";const t=document.createElement("div");t.classList.add("option","selected"),t.textContent="All Genres",t.dataset.value="",l.appendChild(t),r.forEach(n=>{const e=g[n];if(e){const s=document.createElement("div");s.classList.add("option"),s.textContent=e,s.dataset.value=n,l.appendChild(s)}}),_()}function _(){const r=document.querySelectorAll(".library-dropdown-filter .option");r.forEach(t=>{t.addEventListener("click",()=>{m.childNodes[0].textContent=t.textContent,r.forEach(e=>e.classList.remove("selected")),t.classList.add("selected"),i.classList.remove("open"),l.style.display="none",p=t.dataset.value?Number(t.dataset.value):null,f()})})}document.addEventListener("DOMContentLoaded",async()=>{await A(),M(),f()});function f(){const r=document.querySelector(".library-movie-items");let t=JSON.parse(localStorage.getItem("myMovieLibrary"))||[];if(t.length===0){document.querySelector(".library-content").style.display="none",document.querySelector(".library-content-empty").style.display="block";return}let n=t;if(p&&(n=t.filter(e=>{let s=[];return Array.isArray(e.genre_ids)?s=e.genre_ids:Array.isArray(e.genres)&&(s=e.genres.map(a=>a.id)),s.includes(p)})),r.innerHTML="",n.length===0){r.innerHTML="<p class='no-results'>Seçilen türe ait film bulunmamaktadır.</p>";return}n.forEach(e=>{const s=e.title||"Unknown",a=e.poster_path?`https://image.tmdb.org/t/p/w300${e.poster_path}`:"./img/placeholder.jpg",o=e.vote_average??"N/A",y=e.release_date?e.release_date.slice(0,4):"N/A";let c=[];Array.isArray(e.genre_ids)?c=e.genre_ids:Array.isArray(e.genres)&&(c=e.genres.map(u=>u.id));const h=c.map(u=>g[u]).filter(Boolean).join(", "),d=document.createElement("li");d.classList.add("library-movie-item"),d.dataset.movieId=e.id,d.style.cursor="pointer",d.innerHTML=`
            <section class="card">
                <img
                    class="card-image"
                    src="${a}"
                    alt="${s}"
                    loading="lazy"
                />
                <div class="card-content">
                    <h2 class="card-title">${s}</h2>
                    <p class="card-info">
                        <span class="card-genre">${h}</span>
                       
                        | <span class="card-year">${y}</span>
                       
                    </p>
                    <ul class="card-rating">
                        ${w(o)}
                    </ul>
                </div>
            </section>
        `,r.appendChild(d)})}function w(r){const t=r/2,n=Math.floor(t),e=t%1>=.5?1:0,s=5-n-e;let a="";for(let o=0;o<n;o++)a+='<li><svg width="14" height="14"><use href="./img/sprite.svg#full-star"></use></svg></li>';e&&(a+='<li><svg width="14" height="14"><use href="./img/sprite.svg#half-star"></use></svg></li>');for(let o=0;o<s;o++)a+='<li><svg width="14" height="14"><use href="./img/sprite.svg#empty-star"></use></svg></li>';return a}document.addEventListener("click",r=>{const t=r.target.closest(".library-movie-item");t!=null&&t.dataset.movieId&&L(t.dataset.movieId)});
//# sourceMappingURL=myLibrary-3oO1J8HF.js.map

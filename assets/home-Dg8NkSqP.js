import{c as a,o as E}from"./modal-DSgPRClB.js";let l={};const y=a.TMDB_API_KEY,p=a.TMDB_BASE_URL,M=a.TMDB_IMAGE_BASE_URL;async function B(){if(!(Object.keys(l).length>0))try{(await axios.get(`${p}/genre/movie/list?api_key=${y}`)).data.genres.forEach(o=>{l[o.id]=o.name}),console.log("Genres loaded:",l)}catch(t){console.error("Genres couldn't loaded:",t)}}async function I(){try{return(await axios.get(`${p}/trending/movie/week?api_key=${y}`)).data.results}catch(t){return console.error("API hatası:",t),[]}}function b(t){const o=t/2,n=Math.floor(o),e=o-n>=.5?1:0,s=5-n-e;let r="";for(let i=0;i<n;i++)r+=`<li>
        <svg width="14" height="14">
            <use href="./img/sprite.svg#full-star"></use>
        </svg>
    </li>`;e&&(r+='<li><svg width="14" height="14"><use href="./img/sprite.svg#half-star"></use></svg></li>');for(let i=0;i<s;i++)r+='<li><svg width="14" height="14"><use href="./img/sprite.svg#empty-star"></use></svg></li>';return r}async function w(){console.log("Anasayfa yüklendi, API'den veri çekiliyor..."),await B();const t=await I();if(console.log("Movies list"+JSON.stringify(t.map(e=>e.title))),await S(),t.length===0)return;const o=t.slice(0,3),n=document.querySelectorAll(".home-movie-item");o.forEach((e,s)=>{const r=n[s];if(!r)return;const i=r.querySelector(".card-title");i&&(i.textContent=e.title||e.name);const h=e.release_date?e.release_date.split("-")[0]:"—",g=r.querySelector(".card-year");g&&(g.textContent=h);const v=e.poster_path?`${M}/w342${e.poster_path}`:"./img/no-poster.jpg",d=r.querySelector(".card-image");d&&(d.src=v,d.alt=`${e.title} poster`);const _=e.genre_ids.slice(0,2).map(c=>l[c]||"Bilinmiyor").join(", "),u=r.querySelector(".card-genre");u&&(u.textContent=_||"No genres");const m=r.querySelector(".card-rating");m&&(m.innerHTML=b(e.vote_average)),r.style.cursor="pointer",r.addEventListener("click",c=>{c.preventDefault(),c.stopPropagation(),console.log("Karta tıklandı, ID:",e.id),E(e.id)})}),console.log("3 kart başarıyla dolduruldu!")}async function S(){try{const t=await axios.get(`${a.TMDB_BASE_URL}/movie/upcoming?api_key=${a.TMDB_API_KEY}&page=1`),o=new Date().toISOString().split("T")[0],n=t.data.results.filter(i=>i.release_date>=o);if(n.length===0){console.log("There are no upcoming movies this month!");return}const e=n[Math.floor(Math.random()*n.length)];document.getElementById("upcoming-poster").src=e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:"./img/no-poster.jpg",document.getElementById("upcoming-title").textContent=e.title,document.getElementById("upcoming-release").textContent=e.release_date?A(e.release_date):"—",document.getElementById("upcoming-vote").textContent=e.vote_average.toFixed(1),document.getElementById("upcoming-votes").textContent=e.vote_count,document.getElementById("upcoming-popularity").textContent=Math.round(e.popularity);const s=e.genre_ids.slice(0,2).map(i=>l[i]||"Bilinmiyor").join(", ");document.getElementById("upcoming-genre").textContent=s,console.log("Film Açıklaması"+e.overview),document.getElementById("upcoming-overview-content").querySelector("p").textContent=e.overview||"Movie overview couldn't find!",console.log("Upcoming movie yüklendi:",e.title);const r=document.getElementById("upcoming-library-btn");r.dataset.movieId=e.id}catch(t){console.error("Upcoming movie yüklenemedi",t)}}function A(t){const o=["January","February","March","April","May","June","July","August","September","October","November","December"],n=new Date(t);return`${n.getDate()} ${o[n.getMonth()]} ${n.getFullYear()}`}const f="myMovieLibrary";function k(){return JSON.parse(localStorage.getItem(f))||[]}function $(t){const o=k();o.find(n=>n.id===t.id)?alert("This movie is already in your library!"):(o.push(t),localStorage.setItem(f,JSON.stringify(o)),alert(`${t.title} added to your library.`))}document.addEventListener("click",async function(t){if(t.target.id==="upcoming-library-btn"||t.target.classList.contains("card-library-btn")){const o=t.target.dataset.movieId;if(!o)return;try{const n=await axios.get(`${a.TMDB_BASE_URL}/movie/${o}?api_key=${a.TMDB_API_KEY}`);$(n.data),t.target.textContent="Remove from my library",t.target.disabled=!0}catch{alert("An error occurred while adding the movie.")}}});document.addEventListener("DOMContentLoaded",w);
//# sourceMappingURL=home-Dg8NkSqP.js.map

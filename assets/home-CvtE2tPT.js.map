{"version":3,"file":"home-CvtE2tPT.js","sources":["../../src/home.js"],"sourcesContent":["// 1. Axios zaten CDN'den geldi, hazır\n// 2. API anahtarını Vite gibi kullanıyoruz (senin .env dosyan varsa)\nimport config from './config.js';\nimport './js/hero.js';\nimport { openMovieModal } from './js/modal.js';\n\n// en üste ekle (config import’tan sonra)\nlet genreMap = {}; // {28: \"Aksiyon\", 12: \"Macera\", ...}\n\nconst API_KEY = config.TMDB_API_KEY;\nconst BASE_URL = config.TMDB_BASE_URL;\nconst IMAGE_BASE = config.TMDB_IMAGE_BASE_URL;\n// Örnek: const API_KEY = 'c8b152c90517e0e6f9c365d9e0e48c7e';\n\nasync function loadGenres() {\n  if (Object.keys(genreMap).length > 0) return; // zaten yüklendiyse tekrar çekme\n\n  try {\n    const response = await axios.get(\n      `${BASE_URL}/genre/movie/list?api_key=${API_KEY}`\n    );\n    response.data.genres.forEach(g => {\n      genreMap[g.id] = g.name;\n    });\n    console.log('Genres loaded:', genreMap);\n  } catch (err) {\n    console.error(\"Genres couldn't loaded:\", err);\n  }\n}\n\n// TMDB'den haftanın trend filmlerini çeken basit fonksiyon\nasync function getWeeklyTrends() {\n  try {\n    const response = await axios.get(\n      `${BASE_URL}/trending/movie/week?api_key=${API_KEY}`\n    );\n    return response.data.results;\n  } catch (error) {\n    console.error('API hatası:', error);\n    return [];\n  }\n}\n\n// Bu fonksiyonda rating için gerekli olan içleri boş, yarı-dolu ve tam-dolu olan yıldız svg'lerimizi formüllere göre kullanıyoruz.\nfunction createStarRating(vote_average, isHero = false) {\n  const rating = vote_average / 2;\n  const full = Math.floor(rating);\n  const hasHalf = rating - full >= 0.5;\n  const empty = 5 - full - (hasHalf ? 1 : 0);\n\n  let html = '';\n\n  for (let i = 0; i < full; i++) {\n    html += `<li><svg class=\"star-svg\"><use href=\"./img/sprite.svg#full-star\"></use></svg></li>`;\n  }\n  if (hasHalf) {\n    html += `<li><svg class=\"star-svg\"><use href=\"./img/sprite.svg#half-star\"></use></svg></li>`;\n  }\n  for (let i = 0; i < empty; i++) {\n    html += `<li><svg class=\"star-svg\"><use href=\"./img/sprite.svg#empty-star\"></use></svg></li>`;\n  }\n\n  return html;\n}\n\nasync function initHomePage() {\n  console.log(\"Anasayfa yüklendi, API'den veri çekiliyor...\");\n\n  await loadGenres(); // önce türleri yükle\n\n  const movies = await getWeeklyTrends(); // haftanın popüler filmlerini yükle ve movies değişkenine ata\n  console.log('Movies list' + JSON.stringify(movies.map(movie => movie.title)));\n\n  await loadUpcomingMovie(); // upcoming this month filmlerini yükle\n\n  if (movies.length === 0) return;\n\n  // İlk 3 haftanın filmini çekmek için\n  const weeklyMovies = movies.slice(0, 3);\n\n  // Tüm kartları seç (3 tane home-movie-item var)\n  const cardContainers = document.querySelectorAll('.home-movie-item');\n\n  // Haftanın filmlerini içeren array'i gezerek, her bir indexteki elemanın özelliklerini container yapısında buluyoruz\n  weeklyMovies.forEach((movie, index) => {\n    const card = cardContainers[index];\n    if (!card) return;\n\n    // Başlık - Eğer .card-title class'ına sahip bir eleman var ise, bu elemanın içine, API'deki haftanın trendlerinde yer alan her filmin isim bilgisini atıyoruz.\n    const titleEl = card.querySelector('.card-title');\n    if (titleEl) titleEl.textContent = movie.title || movie.name;\n\n    // Yıl - Eğer .card-year class'ına sahip bir eleman var ise, bu elemanın içine, API'deki haftanın trendlerinde yer alan her filmin, \"-\"den sonraki ilk elemanı olan yıl bilgisini atıyoruz.\n    const year = movie.release_date ? movie.release_date.split('-')[0] : '—';\n    const yearEl = card.querySelector('.card-year');\n    if (yearEl) yearEl.textContent = year;\n\n    // Poster - Eğer .card-image class'ına sahip bir eleman var ise, bu elemanın içine, API'deki haftanın trendlerinde yer alan her filmin poster bilgisini atıyoruz.\n    const posterUrl = movie.poster_path\n      ? `${IMAGE_BASE}/w342${movie.poster_path}`\n      : './img/no-poster.jpg';\n    const imgEl = card.querySelector('.card-image');\n    if (imgEl) {\n      imgEl.src = posterUrl;\n      imgEl.alt = `${movie.title} poster`;\n    }\n\n    // Genre (en fazla 2 tür gösterelim) - API'deki haftanın trendlerinde yer alan her filmin, id'sine göre gezerek, içeriğindeki ilk iki değeri alıp, genreMap objesi içerisine ekleten ve bu genre bilgisini, eğer .card-genre class'ına sahip bir eleman var ise, bu elemanın içine atıyoruz.\n    const genres = movie.genre_ids\n      .slice(0, 2)\n      .map(id => genreMap[id] || 'Bilinmiyor')\n      .join(', ');\n    const genreEl = card.querySelector('.card-genre');\n    if (genreEl) genreEl.textContent = genres || 'No genres';\n\n    // Rating (yıldızlar) - Öncelikle createStars fonksiyonunda rating hesaplaması mantığını kuruyoruz ve eğer .card-rating class'ına sahip bir eleman var ise, bu elemanın içine, API'deki haftanın trendlerinde yer alan her filmin rating bilgisini atıyoruz.\n    const ratingEl = card.querySelector('.card-rating');\n    if (ratingEl) {\n      ratingEl.innerHTML = createStarRating(movie.vote_average); // normal kart\n    }\n    card.style.cursor = 'pointer';\n    card.addEventListener('click', e => {\n      e.preventDefault();\n      e.stopPropagation();\n      console.log('Karta tıklandı, ID:', movie.id); // ← bu logu göreceksin\n      openMovieModal(movie.id);\n    });\n  });\n\n  console.log('3 kart başarıyla dolduruldu!');\n}\n\n// ===== UPCOMING THIS MONTH =====\nasync function loadUpcomingMovie() {\n  try {\n    const response = await axios.get(\n      `${config.TMDB_BASE_URL}/movie/upcoming?api_key=${config.TMDB_API_KEY}&page=1`\n    );\n\n    // Bugün ve sonrası olan filmleri alalım\n    const now = new Date().toISOString().split('T')[0];\n    const futureMovies = response.data.results.filter(\n      movie => movie.release_date >= now\n    );\n\n    if (futureMovies.length === 0) {\n      console.log('There are no upcoming movies this month!');\n      return;\n    }\n\n    // Rastgele bir tane seç\n    const movie = futureMovies[Math.floor(Math.random() * futureMovies.length)];\n\n    const posterPath = movie.poster_path || '';\n    // Poster – RESPONSIVE + BOZULMAYAN\n    const posterImg = document.getElementById('upcoming-poster');\n    if (posterPath) {\n      posterImg.srcset = `\n    https://image.tmdb.org/t/p/w342${posterPath} 342w,\n    https://image.tmdb.org/t/p/w500${posterPath} 500w,\n    https://image.tmdb.org/t/p/w780${posterPath} 780w,\n    https://image.tmdb.org/t/p/original${posterPath} 1280w\n  `;\n      posterImg.sizes =\n        '(max-width: 767px) 90vw, (max-width: 1279px) 704px, 805px';\n      posterImg.src = `https://image.tmdb.org/t/p/w780${posterPath}`; // fallback\n      posterImg.alt = `${movie.title} poster`;\n    } else {\n      posterImg.src = './img/no-poster.jpg';\n      posterImg.removeAttribute('srcset');\n      posterImg.removeAttribute('sizes');\n    }\n\n    // Elementleri doldur\n\n    document.getElementById('upcoming-title').textContent = movie.title;\n    document.getElementById('upcoming-release').textContent = movie.release_date\n      ? formatDate(movie.release_date)\n      : '—';\n    document.getElementById('upcoming-vote').textContent =\n      movie.vote_average.toFixed(1);\n    document.getElementById('upcoming-votes').textContent = movie.vote_count;\n    document.getElementById('upcoming-popularity').textContent = Math.round(\n      movie.popularity\n    );\n\n    // Genre\n    const genres = movie.genre_ids\n      .slice(0, 2)\n      .map(id => genreMap[id] || 'Bilinmiyor')\n      .join(', ');\n    document.getElementById('upcoming-genre').textContent = genres;\n\n    console.log('Film Açıklaması' + movie.overview);\n    // Overview\n    document\n      .getElementById('upcoming-overview-content')\n      .querySelector('p').textContent =\n      movie.overview || \"Movie overview couldn't find!\";\n\n    console.log('Upcoming movie yüklendi:', movie.title);\n\n    // Butona film bilgisini ekleyelim (sonraki adımda kullanacağız)\n    const btn = document.getElementById('upcoming-library-btn');\n    btn.dataset.movieId = movie.id;\n  } catch (err) {\n    console.error('Upcoming movie yüklenemedi', err);\n  }\n}\n\n// Güzel tarih formatı: 03 Mart 2025\nfunction formatDate(dateString) {\n  const months = [\n    'January',\n    'February',\n    'March',\n    'April',\n    'May',\n    'June',\n    'July',\n    'August',\n    'September',\n    'October',\n    'November',\n    'December',\n  ];\n  const date = new Date(dateString);\n  return `${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;\n}\n\n// ===== LOCALSTORAGE - KÜTÜPHANE =====\nconst LIBRARY_KEY = 'myMovieLibrary';\n\nfunction getLibrary() {\n  return JSON.parse(localStorage.getItem(LIBRARY_KEY)) || [];\n}\n\nfunction addToLibrary(movie) {\n  const library = getLibrary();\n  if (!library.find(m => m.id === movie.id)) {\n    library.push(movie);\n    localStorage.setItem(LIBRARY_KEY, JSON.stringify(library));\n    alert(`${movie.title} added to your library.`);\n  } else {\n    alert('This movie is already in your library!');\n  }\n}\n\n// Tüm \"Add to my library\" butonları\ndocument.addEventListener('click', async function (e) {\n  if (\n    e.target.id === 'upcoming-library-btn' ||\n    e.target.classList.contains('card-library-btn')\n  ) {\n    const movieId = e.target.dataset.movieId;\n\n    if (!movieId) return;\n\n    try {\n      const res = await axios.get(\n        `${config.TMDB_BASE_URL}/movie/${movieId}?api_key=${config.TMDB_API_KEY}`\n      );\n      addToLibrary(res.data);\n      e.target.textContent = 'Remove from my library';\n      e.target.disabled = true;\n    } catch (err) {\n      alert('An error occurred while adding the movie.');\n    }\n  }\n});\n\n// Sayfa tamamen yüklendiğinde çalışsın\ndocument.addEventListener('DOMContentLoaded', initHomePage);\n"],"names":["genreMap","API_KEY","config","BASE_URL","IMAGE_BASE","loadGenres","g","err","getWeeklyTrends","error","createStarRating","vote_average","isHero","rating","full","hasHalf","empty","html","initHomePage","movies","movie","loadUpcomingMovie","weeklyMovies","cardContainers","index","card","titleEl","year","yearEl","posterUrl","imgEl","genres","id","genreEl","ratingEl","e","openMovieModal","response","now","futureMovies","posterPath","posterImg","formatDate","btn","dateString","months","date","LIBRARY_KEY","getLibrary","addToLibrary","library","m","movieId","res"],"mappings":"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"}
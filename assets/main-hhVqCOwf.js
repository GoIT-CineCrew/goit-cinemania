(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();const l={TMDB_API_KEY:"532c164e7aaa985e6a97f7fc762d2aea",TMDB_BASE_URL:"https://api.themoviedb.org/3",TMDB_IMAGE_BASE_URL:"https://image.tmdb.org/t/p"};console.log("YENİ MODAL.JS YÜKLENDİ - "+new Date().toLocaleTimeString());let E,b,m;function k(){return new Promise(e=>{const r=()=>{E=document.getElementById("movie-modal"),b=document.getElementById("modal-close-btn"),m=document.getElementById("modal-library-btn"),E&&b&&m?(T(),e()):requestAnimationFrame(r)};r()})}function T(){b.addEventListener("click",M),E.addEventListener("click",e=>{e.target.classList.contains("modal-backdrop")&&M()})}function M(){E.classList.remove("show"),document.body.style.overflow="";const e=document.getElementById("modal-trailer-wrapper"),r=document.getElementById("modal-trailer-iframe");e&&(e.style.display="none"),r&&(r.src="")}async function D(e){console.log("openMovieModal çağrıldı, ID:",e),await k();try{const[r,n]=await Promise.all([axios.get(`${l.TMDB_BASE_URL}/movie/${e}?api_key=${l.TMDB_API_KEY}`),axios.get(`${l.TMDB_BASE_URL}/movie/${e}/videos?api_key=${l.TMDB_API_KEY}`)]),t=r.data,a=n.data.results.find(y=>y.site==="YouTube"&&y.type==="Trailer");document.getElementById("modal-poster").src=t.poster_path?`https://image.tmdb.org/t/p/w500${t.poster_path}`:"./img/no-poster.jpg",document.getElementById("modal-title").textContent=t.title,document.getElementById("modal-rating").textContent=`${t.vote_average.toFixed(1)} / ${t.vote_count}`,document.getElementById("modal-popularity").textContent=Math.round(t.popularity),document.getElementById("modal-release").textContent=x(t.release_date),document.getElementById("modal-overview").textContent=t.overview||"Açıklama yok.";const o=document.getElementById("modal-trailer-wrapper"),i=document.getElementById("modal-trailer-iframe");a&&o&&i?(o.style.display="block",i.src=`https://www.youtube.com/embed/${a.key}?autoplay=1&rel=0`):o&&(o.style.display="none"),m.textContent="Add to my library",m.disabled=!1,m.onclick=()=>C(t),E.classList.add("show"),document.body.style.overflow="hidden"}catch(r){console.error("Modal hatası:",r),alert("Movie details could not be loaded!")}}function x(e){if(!e)return"—";const r=["January","February","March","April","May","June","July","August","September","October","November","December"],n=new Date(e);return`${n.getDate()} ${r[n.getMonth()]} ${n.getFullYear()}`}function C(e){const r=JSON.parse(localStorage.getItem("myMovieLibrary")||"[]");if(r.some(n=>n.id===e.id)){alert("This movie is already in your library!");return}r.push(e),localStorage.setItem("myMovieLibrary",JSON.stringify(r)),alert(`${e.title} added to your library.`),m.textContent="Added",m.disabled=!0}const w=l.TMDB_API_KEY,I=l.TMDB_BASE_URL;async function P(){var r;try{let _=function(s){return`<svg class="star-icon" width="14" height="14"><use href="#${s}-star"></use></svg>`};var e=_;const n=await fetch(`${I}/trending/movie/week?api_key=${w}`);if(!n.ok)throw new Error(`API Hatası: ${n.status} ${n.statusText}`);const a=(await n.json()).results;if(!a||a.length===0)throw new Error("Film gelmedi");const o=a[Math.floor(Math.random()*a.length)],g=(r=(await(await fetch(`${I}/movie/${o.id}/videos?api_key=${w}`)).json()).results)==null?void 0:r.find(s=>s.type==="Trailer"&&s.site==="YouTube");document.getElementById("hero-default").style.display="none";const c=document.getElementById("hero-random-movie");c.style.display="flex",o.backdrop_path&&(c.style.backgroundImage=`ur[](https://image.tmdb.org/t/p/original${o.backdrop_path})`),c.querySelector(".hero-movie-title").textContent=o.title,c.querySelector(".hero-movie-details").textContent=o.overview||"Açıklama yok.";const p=document.getElementById("hero-movie-poster");p.src=o.poster_path?`https://image.tmdb.org/t/p/w500${o.poster_path}`:"https://via.placeholder.com/500x750?text=No+Image";const u=c.querySelector(".hero-movie-stars");u.innerHTML="";const f=Math.round(o.vote_average||0),h=Math.floor(f/2),d=f%2?1:0,S=5-h-d;for(let s=0;s<h;s++)u.innerHTML+=_("full");for(let s=0;s<d;s++)u.innerHTML+=_("half");for(let s=0;s<S;s++)u.innerHTML+=_("empty");const B=document.getElementById("watch-trailer-btn");B&&g&&(B.onclick=()=>{const s=document.createElement("div");s.className="movie-popup-overlay",s.innerHTML=`
          <div class="popup-video-wrapper">
            <iframe src="https://www.youtube.com/embed/${g.key}?autoplay=1" 
                    allow="autoplay" allowfullscreen></iframe>
          </div>`,document.body.appendChild(s),s.onclick=()=>s.remove()}),document.getElementById("more-details-btn").onclick=()=>{typeof deleteHeroTrendsPopup=="function"&&deleteHeroTrendsPopup(o)}}catch(n){console.error("Hero yüklenemedi:",n),document.getElementById("hero-default").style.display="block",document.getElementById("hero-random-movie").style.display="none"}}document.addEventListener("DOMContentLoaded",P);let v={};const $=l.TMDB_API_KEY,L=l.TMDB_BASE_URL,R=l.TMDB_IMAGE_BASE_URL;async function O(){if(!(Object.keys(v).length>0))try{(await axios.get(`${L}/genre/movie/list?api_key=${$}`)).data.genres.forEach(r=>{v[r.id]=r.name}),console.log("Genres loaded:",v)}catch(e){console.error("Genres couldn't loaded:",e)}}async function Y(){try{return(await axios.get(`${L}/trending/movie/week?api_key=${$}`)).data.results}catch(e){return console.error("API hatası:",e),[]}}function N(e){const r=e/2,n=Math.floor(r),t=r-n>=.5?1:0,a=5-n-t;let o="";for(let i=0;i<n;i++)o+=`<li>
        <svg width="14" height="14">
            <use href="./img/sprite.svg#full-star"></use>
        </svg>
    </li>`;t&&(o+='<li><svg width="14" height="14"><use href="./img/sprite.svg#half-star"></use></svg></li>');for(let i=0;i<a;i++)o+='<li><svg width="14" height="14"><use href="./img/sprite.svg#empty-star"></use></svg></li>';return o}async function U(){console.log("Anasayfa yüklendi, API'den veri çekiliyor..."),await O();const e=await Y();if(console.log("Movies list"+JSON.stringify(e.map(t=>t.title))),await K(),e.length===0)return;const r=e.slice(0,3),n=document.querySelectorAll(".home-movie-item");r.forEach((t,a)=>{const o=n[a];if(!o)return;const i=o.querySelector(".card-title");i&&(i.textContent=t.title||t.name);const y=t.release_date?t.release_date.split("-")[0]:"—",g=o.querySelector(".card-year");g&&(g.textContent=y);const c=t.poster_path?`${R}/w342${t.poster_path}`:"./img/no-poster.jpg",p=o.querySelector(".card-image");p&&(p.src=c,p.alt=`${t.title} poster`);const u=t.genre_ids.slice(0,2).map(d=>v[d]||"Bilinmiyor").join(", "),f=o.querySelector(".card-genre");f&&(f.textContent=u||"No genres");const h=o.querySelector(".card-rating");h&&(h.innerHTML=N(t.vote_average)),o.style.cursor="pointer",o.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),console.log("Karta tıklandı, ID:",t.id),D(t.id)})}),console.log("3 kart başarıyla dolduruldu!")}async function K(){try{const e=await axios.get(`${l.TMDB_BASE_URL}/movie/upcoming?api_key=${l.TMDB_API_KEY}&page=1`),r=new Date().toISOString().split("T")[0],n=e.data.results.filter(i=>i.release_date>=r);if(n.length===0){console.log("There are no upcoming movies this month!");return}const t=n[Math.floor(Math.random()*n.length)];document.getElementById("upcoming-poster").src=t.poster_path?`https://image.tmdb.org/t/p/w500${t.poster_path}`:"./img/no-poster.jpg",document.getElementById("upcoming-title").textContent=t.title,document.getElementById("upcoming-release").textContent=t.release_date?q(t.release_date):"—",document.getElementById("upcoming-vote").textContent=t.vote_average.toFixed(1),document.getElementById("upcoming-votes").textContent=t.vote_count,document.getElementById("upcoming-popularity").textContent=Math.round(t.popularity);const a=t.genre_ids.slice(0,2).map(i=>v[i]||"Bilinmiyor").join(", ");document.getElementById("upcoming-genre").textContent=a,console.log("Film Açıklaması"+t.overview),document.getElementById("upcoming-overview-content").querySelector("p").textContent=t.overview||"Movie overview couldn't find!",console.log("Upcoming movie yüklendi:",t.title);const o=document.getElementById("upcoming-library-btn");o.dataset.movieId=t.id}catch(e){console.error("Upcoming movie yüklenemedi",e)}}function q(e){const r=["January","February","March","April","May","June","July","August","September","October","November","December"],n=new Date(e);return`${n.getDate()} ${r[n.getMonth()]} ${n.getFullYear()}`}const A="myMovieLibrary";function H(){return JSON.parse(localStorage.getItem(A))||[]}function J(e){const r=H();r.find(n=>n.id===e.id)?alert("This movie is already in your library!"):(r.push(e),localStorage.setItem(A,JSON.stringify(r)),alert(`${e.title} added to your library.`))}document.addEventListener("click",async function(e){if(e.target.id==="upcoming-library-btn"||e.target.classList.contains("card-library-btn")){const r=e.target.dataset.movieId;if(!r)return;try{const n=await axios.get(`${l.TMDB_BASE_URL}/movie/${r}?api_key=${l.TMDB_API_KEY}`);J(n.data),e.target.textContent="Remove from my library",e.target.disabled=!0}catch{alert("An error occurred while adding the movie.")}}});document.addEventListener("DOMContentLoaded",U);
//# sourceMappingURL=main-hhVqCOwf.js.map

(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}})();const s={TMDB_API_KEY:"532c164e7aaa985e6a97f7fc762d2aea",TMDB_BASE_URL:"https://api.themoviedb.org/3",TMDB_IMAGE_BASE_URL:"https://image.tmdb.org/t/p"};console.log("YENİ MODAL.JS YÜKLENDİ - "+new Date().toLocaleTimeString());let d,y,l;function I(){return new Promise(e=>{const o=()=>{d=document.getElementById("movie-modal"),y=document.getElementById("modal-close-btn"),l=document.getElementById("modal-library-btn"),d&&y&&l?(w(),e()):requestAnimationFrame(o)};o()})}function w(){y.addEventListener("click",v),d.addEventListener("click",e=>{e.target.classList.contains("modal-backdrop")&&v()})}function v(){d.classList.remove("show"),document.body.style.overflow="";const e=document.getElementById("modal-trailer-wrapper"),o=document.getElementById("modal-trailer-iframe");e&&(e.style.display="none"),o&&(o.src="")}async function A(e){console.log("openMovieModal çağrıldı, ID:",e),await I();try{const[o,n]=await Promise.all([axios.get(`${s.TMDB_BASE_URL}/movie/${e}?api_key=${s.TMDB_API_KEY}`),axios.get(`${s.TMDB_BASE_URL}/movie/${e}/videos?api_key=${s.TMDB_API_KEY}`)]),t=o.data,a=n.data.results.find(m=>m.site==="YouTube"&&m.type==="Trailer");document.getElementById("modal-poster").src=t.poster_path?`https://image.tmdb.org/t/p/w500${t.poster_path}`:"./img/no-poster.jpg",document.getElementById("modal-title").textContent=t.title,document.getElementById("modal-rating").textContent=`${t.vote_average.toFixed(1)} / ${t.vote_count}`,document.getElementById("modal-popularity").textContent=Math.round(t.popularity),document.getElementById("modal-release").textContent=L(t.release_date),document.getElementById("modal-overview").textContent=t.overview||"Açıklama yok.";const r=document.getElementById("modal-trailer-wrapper"),i=document.getElementById("modal-trailer-iframe");a&&r&&i?(r.style.display="block",i.src=`https://www.youtube.com/embed/${a.key}?autoplay=1&rel=0`):r&&(r.style.display="none"),l.textContent="Add to my library",l.disabled=!1,l.onclick=()=>S(t),d.classList.add("show"),document.body.style.overflow="hidden"}catch(o){console.error("Modal hatası:",o),alert("Movie details could not be loaded!")}}function L(e){if(!e)return"—";const o=["January","February","March","April","May","June","July","August","September","October","November","December"],n=new Date(e);return`${n.getDate()} ${o[n.getMonth()]} ${n.getFullYear()}`}function S(e){const o=JSON.parse(localStorage.getItem("myMovieLibrary")||"[]");if(o.some(n=>n.id===e.id)){alert("This movie is already in your library!");return}o.push(e),localStorage.setItem("myMovieLibrary",JSON.stringify(o)),alert(`${e.title} added to your library.`),l.textContent="Added",l.disabled=!0}let c={};const E=s.TMDB_API_KEY,_=s.TMDB_BASE_URL,$=s.TMDB_IMAGE_BASE_URL;async function D(){if(!(Object.keys(c).length>0))try{(await axios.get(`${_}/genre/movie/list?api_key=${E}`)).data.genres.forEach(o=>{c[o.id]=o.name}),console.log("Genres loaded:",c)}catch(e){console.error("Genres couldn't loaded:",e)}}async function x(){try{return(await axios.get(`${_}/trending/movie/week?api_key=${E}`)).data.results}catch(e){return console.error("API hatası:",e),[]}}function T(e){const o=e/2,n=Math.floor(o),t=o-n>=.5?1:0,a=5-n-t;let r="";for(let i=0;i<n;i++)r+=`<li>
        <svg width="14" height="14">
            <use href="./img/sprite.svg#full-star"></use>
        </svg>
    </li>`;t&&(r+='<li><svg width="14" height="14"><use href="./img/sprite.svg#half-star"></use></svg></li>');for(let i=0;i<a;i++)r+='<li><svg width="14" height="14"><use href="./img/sprite.svg#empty-star"></use></svg></li>';return r}async function k(){console.log("Anasayfa yüklendi, API'den veri çekiliyor..."),await D();const e=await x();if(console.log("Movies list"+JSON.stringify(e.map(t=>t.title))),await C(),e.length===0)return;const o=e.slice(0,3),n=document.querySelectorAll(".home-movie-item");o.forEach((t,a)=>{const r=n[a];if(!r)return;const i=r.querySelector(".card-title");i&&(i.textContent=t.title||t.name);const m=t.release_date?t.release_date.split("-")[0]:"—",p=r.querySelector(".card-year");p&&(p.textContent=m);const B=t.poster_path?`${$}/w342${t.poster_path}`:"./img/no-poster.jpg",g=r.querySelector(".card-image");g&&(g.src=B,g.alt=`${t.title} poster`);const M=t.genre_ids.slice(0,2).map(u=>c[u]||"Bilinmiyor").join(", "),f=r.querySelector(".card-genre");f&&(f.textContent=M||"No genres");const h=r.querySelector(".card-rating");h&&(h.innerHTML=T(t.vote_average)),r.style.cursor="pointer",r.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),console.log("Karta tıklandı, ID:",t.id),A(t.id)})}),console.log("3 kart başarıyla dolduruldu!")}async function C(){try{const e=await axios.get(`${s.TMDB_BASE_URL}/movie/upcoming?api_key=${s.TMDB_API_KEY}&page=1`),o=new Date().toISOString().split("T")[0],n=e.data.results.filter(i=>i.release_date>=o);if(n.length===0){console.log("There are no upcoming movies this month!");return}const t=n[Math.floor(Math.random()*n.length)];document.getElementById("upcoming-poster").src=t.poster_path?`https://image.tmdb.org/t/p/w500${t.poster_path}`:"./img/no-poster.jpg",document.getElementById("upcoming-title").textContent=t.title,document.getElementById("upcoming-release").textContent=t.release_date?O(t.release_date):"—",document.getElementById("upcoming-vote").textContent=t.vote_average.toFixed(1),document.getElementById("upcoming-votes").textContent=t.vote_count,document.getElementById("upcoming-popularity").textContent=Math.round(t.popularity);const a=t.genre_ids.slice(0,2).map(i=>c[i]||"Bilinmiyor").join(", ");document.getElementById("upcoming-genre").textContent=a,console.log("Film Açıklaması"+t.overview),document.getElementById("upcoming-overview-content").querySelector("p").textContent=t.overview||"Movie overview couldn't find!",console.log("Upcoming movie yüklendi:",t.title);const r=document.getElementById("upcoming-library-btn");r.dataset.movieId=t.id}catch(e){console.error("Upcoming movie yüklenemedi",e)}}function O(e){const o=["January","February","March","April","May","June","July","August","September","October","November","December"],n=new Date(e);return`${n.getDate()} ${o[n.getMonth()]} ${n.getFullYear()}`}const b="myMovieLibrary";function P(){return JSON.parse(localStorage.getItem(b))||[]}function R(e){const o=P();o.find(n=>n.id===e.id)?alert("This movie is already in your library!"):(o.push(e),localStorage.setItem(b,JSON.stringify(o)),alert(`${e.title} added to your library.`))}document.addEventListener("click",async function(e){if(e.target.id==="upcoming-library-btn"||e.target.classList.contains("card-library-btn")){const o=e.target.dataset.movieId;if(!o)return;try{const n=await axios.get(`${s.TMDB_BASE_URL}/movie/${o}?api_key=${s.TMDB_API_KEY}`);R(n.data),e.target.textContent="Remove from my library",e.target.disabled=!0}catch{alert("An error occurred while adding the movie.")}}});document.addEventListener("DOMContentLoaded",k);
//# sourceMappingURL=main-hCAAkhDf.js.map

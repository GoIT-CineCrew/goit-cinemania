(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}})();const f={TMDB_API_KEY:"532c164e7aaa985e6a97f7fc762d2aea",TMDB_BASE_URL:"https://api.themoviedb.org/3",TMDB_IMAGE_BASE_URL:"https://image.tmdb.org/t/p"};console.log("YENİ MODAL.JS YÜKLENDİ - "+new Date().toLocaleTimeString());let h,E,c;function x(){return new Promise(t=>{const o=()=>{h=document.getElementById("movie-modal"),E=document.getElementById("modal-close-btn"),c=document.getElementById("modal-library-btn"),h&&E&&c?(D(),t()):requestAnimationFrame(o)};o()})}function D(){E.addEventListener("click",I),h.addEventListener("click",t=>{t.target.classList.contains("modal-backdrop")&&I()})}function I(){h.classList.remove("show"),document.body.style.overflow="";const t=document.getElementById("modal-trailer-wrapper"),o=document.getElementById("modal-trailer-iframe");t&&(t.style.display="none"),o&&(o.src="")}async function P(t){console.log("openMovieModal çağrıldı, ID:",t),await x();try{const[o,e]=await Promise.all([axios.get(`${f.TMDB_BASE_URL}/movie/${t}?api_key=${f.TMDB_API_KEY}`),axios.get(`${f.TMDB_BASE_URL}/movie/${t}/videos?api_key=${f.TMDB_API_KEY}`)]),r=o.data,n=e.data.results.find(d=>d.site==="YouTube"&&d.type==="Trailer");document.getElementById("modal-poster").src=r.poster_path?`https://image.tmdb.org/t/p/w500${r.poster_path}`:"./img/no-poster.jpg",document.getElementById("modal-title").textContent=r.title,document.getElementById("modal-vote").textContent=r.vote_average.toFixed(1),document.getElementById("modal-votes").textContent=r.vote_count,document.getElementById("modal-popularity").textContent=Math.round(r.popularity);const a=document.getElementById("modal-genre");if(r.genres&&r.genres.length>0){const d=r.genres.map(u=>u.name),i=window.innerWidth<768?2:3;if(d.length<=i)a.textContent=d.join(", ");else{const u=d.slice(0,i).join(", "),p=d.length-i;a.textContent=`${u} +${p}`,a.title=d.join(", ")}}else a.textContent="—";document.getElementById("modal-overview").textContent=r.overview||"Açıklama yok.";const s=document.getElementById("modal-trailer-wrapper"),l=document.getElementById("modal-trailer-iframe");n&&s&&l?(s.style.display="block",l.src=`https://www.youtube.com/embed/${n.key}?autoplay=1&rel=0`):s&&(s.style.display="none"),O(r)?(c.textContent="Remove from library",c.disabled=!1,c.onclick=()=>T(r)):(c.textContent="Add to my library",c.disabled=!1,c.onclick=()=>B(r)),h.classList.add("show"),document.body.style.overflow="hidden"}catch(o){console.error("Modal hatası:",o),alert("Movie details could not be loaded!")}}function B(t){const o=JSON.parse(localStorage.getItem("myMovieLibrary")||"[]");if(o.some(e=>e.id===t.id)){alert("This movie is already in your library!");return}o.push(t);try{localStorage.setItem("myMovieLibrary",JSON.stringify(o)),alert(`${t.title} added to your library.`),c.textContent="Remove from library",c.disabled=!1,c.onclick=()=>T(t)}catch(e){console.error("Local storage'a kaydetme hatası:",e),alert("Filmi eklerken bir sorun oluştu.")}}function O(t){return JSON.parse(localStorage.getItem("myMovieLibrary")||"[]").some(e=>e.id===t.id)}function T(t){const e=JSON.parse(localStorage.getItem("myMovieLibrary")||"[]").filter(r=>r.id!==t.id);try{localStorage.setItem("myMovieLibrary",JSON.stringify(e)),alert(`${t.title} kütüphanenizden kaldırıldı.`),c.textContent="Add to my library",c.disabled=!1,c.onclick=()=>B(t)}catch(r){console.error("Local storage'dan silme hatası:",r),alert("Kaldırılırken bir sorun oluştu.")}}const L=f.TMDB_API_KEY,w=f.TMDB_BASE_URL;function q(t){const o=t/2,e=Math.floor(o),r=o-e>=.5,n=5-e-(r?1:0);let a="";for(let s=0;s<e;s++)a+='<li><svg class="star-svg"><use href="./img/sprite.svg#full-star"></use></svg></li>';r&&(a+='<li><svg class="star-svg"><use href="./img/sprite.svg#half-star"></use></svg></li>');for(let s=0;s<n;s++)a+='<li><svg class="star-svg"><use href="./img/sprite.svg#empty-star"></use></svg></li>';return a}async function C(){try{const t=localStorage.getItem("myMovieLibrary");if(!t)return null;const o=JSON.parse(t);if(!Array.isArray(o)||o.length===0)return null;const e=o[Math.floor(Math.random()*o.length)],r=typeof e=="number"?e:e.id;if(!r)return null;const n=await fetch(`${w}/movie/${r}?api_key=${L}&append_to_response=videos`);return n.ok?await n.json():null}catch(t){return console.error("Kütüphaneden film çekilemedi:",t),null}}function N(t,o=20){const e=t.trim().split(/\s+/);return e.length<=o?t:e.slice(0,o).join(" ")+"..."}async function R(){var n,a;const t=document.getElementById("hero-default"),o=document.getElementById("hero-random-movie");if(!o||o.dataset.heroLoaded==="true")return;let e=null,r=null;try{if(document.querySelector('[data-hero-mode="library"]')&&(e=await C(),e||console.log("Kütüphane boş veya hata → trending film kullanılıyor")),!e){const m=await fetch(`${w}/trending/movie/week?api_key=${L}`);if(!m.ok)throw new Error("API Hatası");const b=await m.json();e=b.results[Math.floor(Math.random()*b.results.length)]}(n=e.videos)!=null&&n.results?r=e.videos.results.find(m=>m.site==="YouTube"&&["Trailer","Teaser","Clip"].includes(m.type)):r=(a=(await(await fetch(`${w}/movie/${e.id}/videos?api_key=${L}`)).json()).results)==null?void 0:a.find(M=>M.site==="YouTube"&&["Trailer","Teaser","Clip"].includes(M.type)),t.style.display="none",o.style.display="flex",o.querySelector(".hero-movie-title").textContent=e.title;const l=o.querySelector(".hero-movie-details"),y=e.overview||"Açıklama yok.";l.textContent=N(y,20),y.split(/\s+/).length>20&&(l.title=y),o.querySelector(".hero-movie-stars").innerHTML=`
      <ul class="card-rating hero-rating">${q(e.vote_average)}</ul>
    `;const d=o.querySelector(".hero-movie-poster-crop"),g=e.backdrop_path?`https://image.tmdb.org/t/p/original${e.backdrop_path}`:e.poster_path?`https://image.tmdb.org/t/p/w1280${e.poster_path}`:"./img/no-poster.jpg";d.style.backgroundImage=`url(${g})`;const i=document.getElementById("trailer-modal"),u=document.getElementById("watch-trailer-btn"),p=i.querySelector(".trailer-content"),$=()=>{r&&(p.innerHTML=`
          <button class="trailer-close-btn" type="button">
            <svg><use href="./img/sprite.svg#close-mobile"></use></svg>
          </button>
          <iframe src="https://www.youtube.com/embed/${r.key}?autoplay=1&rel=0" 
                  allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe>
        `),i.style.display="block"},v=()=>{i.style.display="none",p.innerHTML=`
        <button class="trailer-close-btn" type="button">
          <svg><use href="./img/sprite.svg#close-mobile"></use></svg>
        </button>
        <p class="trailer-info">OOPS...<br>We are very sorry!<br>But we couldn’t find the trailer.</p>
        <img src="./img/Trailer-Error-Mobile.png" srcset="./img/Trailer-Error-Desktop@2x.png 2x" alt="Trailer not found" class="trailer-image">
      `};u.onclick=$,i.querySelector(".trailer-close-btn").onclick=v,i.onclick=m=>m.target===i&&v(),document.addEventListener("keydown",m=>m.key==="Escape"&&i.style.display==="block"&&v()),document.getElementById("more-details-btn").onclick=async()=>{await P(e.id)},o.dataset.heroLoaded="true"}catch(s){console.error("Hero yüklenemedi:",s),t.style.display="block",o.style.display="none"}}function k(){const t=document.getElementById("hero-random-movie"),o=document.getElementById("hero-default");!t||!o||t.dataset.heroLoaded!=="true"&&R().then(()=>{t.dataset.heroLoaded="true"})}const S=new MutationObserver(t=>{t.forEach(o=>{o.addedNodes.forEach(e=>{var r;e.nodeType===1&&(e.id==="hero-random-movie"||(r=e.querySelector)!=null&&r.call(e,"#hero-random-movie"))&&k()})})});document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{S.observe(document.body,{childList:!0,subtree:!0}),k()}):(S.observe(document.body,{childList:!0,subtree:!0}),k());window.setActiveNavLink=function(){setTimeout(()=>{const t=location.pathname.split("/").pop()||"index.html";document.querySelectorAll("a[href]").forEach(e=>{let r=e.getAttribute("href")||"";if(r=r.replace(/^\.?\//,""),r===t||(t==="index.html"||t===""||t==="home.html")&&(r==="home.html"||r==="index.html")){e.classList.add("active");const l=e.closest("li");l&&l.classList.add("active")}else{e.classList.remove("active");const l=e.closest("li");l&&l.classList.remove("active")}})},100)};document.addEventListener("DOMContentLoaded",window.setActiveNavLink);document.addEventListener("load:partial",window.setActiveNavLink);document.addEventListener("DOMContentLoaded",()=>{const t=setInterval(()=>{document.querySelector(".header-nav-link")&&(window.setActiveNavLink(),clearInterval(t))},200)});const _=document.querySelectorAll(".theme-toggle-btn"),A=t=>{document.documentElement.dataset.theme=t,localStorage.setItem("theme",t),document.querySelectorAll(".theme-toggle-btn").forEach(o=>{o.style.transform="scale(0.9)",setTimeout(()=>o.style.transform="",200)}),_.forEach(o=>{var s,l,y,d,g,i,u,p;const e=o.querySelector('[href$="moon"]'),r=o.querySelector('[href$="sun"]'),n=o.querySelector('[href*="moon-circle"]'),a=o.querySelector('[href*="sun-circle"]');t==="light"?((s=e==null?void 0:e.parentElement)==null||s.style.setProperty("display","none"),(l=r==null?void 0:r.parentElement)==null||l.style.removeProperty("display"),(y=n==null?void 0:n.parentElement)==null||y.style.setProperty("display","none"),(d=a==null?void 0:a.parentElement)==null||d.style.removeProperty("display")):((g=e==null?void 0:e.parentElement)==null||g.style.removeProperty("display"),(i=r==null?void 0:r.parentElement)==null||i.style.setProperty("display","none"),(u=n==null?void 0:n.parentElement)==null||u.style.removeProperty("display"),(p=a==null?void 0:a.parentElement)==null||p.style.setProperty("display","none"))})};_.forEach(t=>{t.addEventListener("click",()=>{const e=(document.documentElement.dataset.theme||"dark")==="dark"?"light":"dark";A(e)})});document.addEventListener("DOMContentLoaded",()=>{const t=localStorage.getItem("theme"),o=window.matchMedia("(prefers-color-scheme: dark)").matches,e=t||(o?"dark":"light");e&&(document.documentElement.dataset.theme=e),A(document.documentElement.dataset.theme||"dark")});export{f as c,P as o};
//# sourceMappingURL=theme-DVcXdYGc.js.map

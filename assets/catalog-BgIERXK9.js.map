{"version":3,"file":"catalog-BgIERXK9.js","sources":["../../src/catalog.js"],"sourcesContent":["import { openMovieModal } from './js/modal.js';\n\nconst genreMap = {};\n\n// ---- API CONFIG ----\nconst API_KEY = \"aaf24ac7ab7c5211361a71263e777bb9\";\nconst BASE_URL = \"https://api.themoviedb.org/3\";\nconst IMAGE_BASE_URL = \"https://image.tmdb.org/t/p/w500\";\n\n// ---- DOM ELEMENTS ----\nconst movieList = document.querySelector(\".catalog-movie-items\");\nconst searchInput = document.querySelector(\".catalog-search input\");\nconst searchBtn = document.querySelector(\".search-icon\");\nconst clearBtn = document.querySelector(\".clear-button\");\n// Sabit 5 butonu HTML'den seÃ§iyoruz\nconst paginationContainer = document.querySelector(\".catalog-pages\");\nconst pageButtons = document.querySelectorAll(\".catalog-page-btn\"); \n\n// ---- DROPDOWN DOM ----\nconst selectBox = document.querySelector('.catalog-dropdown-filter');\nconst selected = selectBox.querySelector('.selected');\nconst optionsContainer = selectBox.querySelector('.options');\nconst optionsList = selectBox.querySelectorAll('.option');\n\nlet selectedYear = null;\nlet currentPage = 1;\n\n// ----------------------------------------------------------------------\n// ðŸ§° YARDIMCI FONKSÄ°YONLAR\n// ----------------------------------------------------------------------\n\n// Genresleri API'den Ã§ekme\nasync function loadGenres() {\n    if (Object.keys(genreMap).length > 0) return;\n\n    try {\n        const response = await axios.get(`${BASE_URL}/genre/movie/list`, {\n            params: { api_key: API_KEY, language: \"en-US\" }\n        });\n        response.data.genres.forEach(g => {\n            genreMap[g.id] = g.name;\n        });\n    } catch (err) {\n        console.error(\"TÃ¼rler yÃ¼klenemedi:\", err);\n    }\n}\n\n// YÄ±ldÄ±zlarÄ± oluÅŸturma\nfunction createStarRating(vote_average) {\n    const ratingOutOfFive = (vote_average || 0) / 2;\n    const fullStars = Math.floor(ratingOutOfFive);\n    const halfStar = ratingOutOfFive % 1 >= 0.5 ? 1 : 0;\n    const emptyStars = 5 - fullStars - halfStar;\n    let starsHTML = \"\";\n\n    for (let i = 0; i < fullStars; i++) {\n        starsHTML += `<li><svg width=\"14\" height=\"14\"><use href=\"./img/sprite.svg#full-star\"></use></svg></li>`;\n    }\n    if (halfStar) {\n        starsHTML += `<li><svg width=\"14\" height=\"14\"><use href=\"./img/sprite.svg#half-star\"></use></svg></li>`;\n    }\n    for (let i = 0; i < emptyStars; i++) {\n        starsHTML += `<li><svg width=\"14\" height=\"14\"><use href=\"./img/sprite.svg#empty-star\"></use></svg></li>`;\n    }\n    return starsHTML;\n}\n\n// Film kartlarÄ±nÄ± oluÅŸturma\nfunction createMovieCard(movie) {\n    const year = movie.release_date ? movie.release_date.slice(0, 4) : \"N/A\";\n    \n    const genres = movie.genre_ids && movie.genre_ids.length > 0\n        ? movie.genre_ids.map(id => genreMap[id]).filter(Boolean).join(\", \")\n        : \"Unknown\";\n        \n    const poster = movie.poster_path\n        ? `${IMAGE_BASE_URL}${movie.poster_path}`\n        : \"./img/no-poster.jpg\";\n\n    const ratingStars = createStarRating(movie.vote_average);\n\n    return `\n      <li class=\"catalog-movie-item\" data-movie-id=\"${movie.id}\">\n        <section class=\"card\" style=\"cursor: pointer;\">\n          <img\n            class=\"card-image\"\n            src=\"${poster}\"\n            alt=\"${movie.title}\"\n            loading=\"lazy\"\n          />\n          <div class=\"card-content\">\n            <h2 class=\"card-title\">${movie.title}</h2>\n            <p class=\"card-info\">\n              <span class=\"card-genre\">${genres}</span> |\n              <span class=\"card-year\">${year}</span>\n            </p>\n            <ul class=\"card-rating\">${ratingStars}</ul>\n          </div>\n        </section>\n      </li>\n    `;\n}\n\n// Filmleri renderlama\nfunction renderMovies(movies) {\n    movieList.innerHTML = '';\n    movies.forEach(movie => {\n        if (!movie.poster_path) return;\n        movieList.insertAdjacentHTML('beforeend', createMovieCard(movie));\n    });\n    window.scrollTo({ top: 0, behavior: 'smooth' });\n}\n\n// Sayfalama butonlarÄ±nÄ± aktif etme (Statik butonlar iÃ§in)\nfunction updatePaginationButtons(page) {\n    // pageButtons DOM listesi gÃ¼ncel olmayabilir, bu yÃ¼zden tekrar seÃ§iyoruz.\n    const currentButtons = document.querySelectorAll(\".catalog-page-btn\");\n\n    currentButtons.forEach(button => {\n        button.classList.remove(\"active\");\n        // Butonun iÃ§indeki sayfa numarasÄ±nÄ± bulup karÅŸÄ±laÅŸtÄ±rÄ±yoruz.\n        // DÄ°KKAT: Sayfa numaralarÄ± SVG'lerin iÃ§ine gÃ¶mÃ¼lÃ¼ olmadÄ±ÄŸÄ± iÃ§in,\n        // bu fonksiyon dÃ¼zgÃ¼n Ã§alÄ±ÅŸmaz. Bu yÃ¼zden HTML'deki SVG'lerin kaldÄ±rÄ±lÄ±p\n        // numaralarÄ±n buton metni olarak eklenmesi gerekir (Ã–nceki HTML yapÄ±sÄ±).\n        // EÄŸer butonlarda sadece \"01\", \"02\" metni varsa, bu mantÄ±k doÄŸru Ã§alÄ±ÅŸÄ±r:\n        const buttonText = button.textContent.trim().replace(/^0+/, ''); // \"01\" -> \"1\"\n        if (parseInt(buttonText) === page) {\n            button.classList.add(\"active\");\n        }\n    });\n    currentPage = page;\n}\n\n// ----------------------------------------------------------------------\n// âš¡ï¸ ANA Ä°ÅžLEV (handleMovieRequest, Kod TekrarÄ±nÄ± AzaltÄ±r) âš¡ï¸\n// ----------------------------------------------------------------------\n\nasync function handleMovieRequest(page = 1) {\n    await loadGenres(); // TÃ¼rleri her zaman yÃ¼kle\n\n    const query = searchInput.value.trim();\n    let url = \"\";\n    let params = {\n        api_key: API_KEY,\n        language: \"en-US\",\n        page: page,\n    };\n\n    if (query) {\n        // Arama sorgusu varsa: /search/movie uÃ§ noktasÄ±nÄ± kullan\n        url = `${BASE_URL}/search/movie`;\n        params.query = query;\n        if (selectedYear) {\n            params.primary_release_year = selectedYear;\n        }\n    } else if (selectedYear) {\n        // Sadece yÄ±l filtresi varsa: /discover/movie uÃ§ noktasÄ±nÄ± kullan\n        url = `${BASE_URL}/discover/movie`;\n        params.sort_by = \"popularity.desc\";\n        params.primary_release_year = selectedYear;\n    } else {\n        // HiÃ§bir filtre yoksa: /movie/popular uÃ§ noktasÄ±nÄ± kullan\n        url = `${BASE_URL}/movie/popular`;\n    }\n\n    try {\n        const res = await axios.get(url, { params });\n        renderMovies(res.data.results);\n        // Bu fonksiyonun doÄŸru Ã§alÄ±ÅŸmasÄ± iÃ§in HTML'deki SVG'li butonlarÄ±n sadece metin iÃ§ermesi gerekir.\n        updatePaginationButtons(page); \n    } catch (err) {\n        console.error(\"Film isteÄŸi hatasÄ±:\", err);\n    }\n}\n\n// ----------------------------------------------------------------------\n// ðŸŽ¯ OLAY DÄ°NLEYÄ°CÄ°LERÄ° (EVENTS)\n// ----------------------------------------------------------------------\n\n// --- Dropdown aÃ§/kapa --- (TekrarÄ± KaldÄ±rÄ±ldÄ±)\nselected.addEventListener('click', () => {\n    const isOpen = selectBox.classList.toggle('open');\n    optionsContainer.style.display = isOpen ? 'block' : 'none';\n});\n\n// --- Bir seÃ§enek seÃ§ildiÄŸinde --- (TekrarÄ± KaldÄ±rÄ±ldÄ±)\noptionsList.forEach(option => {\n    option.addEventListener('click', () => {\n        // sadece text'i deÄŸiÅŸtir\n        selected.childNodes[0].textContent = option.textContent;\n\n        // seÃ§ili class'Ä± gÃ¼ncelle\n        optionsList.forEach(o => o.classList.remove('selected'));\n        option.classList.add('selected');\n\n        // menÃ¼yÃ¼ kapat\n        selectBox.classList.remove('open');\n        optionsContainer.style.display = 'none';\n\n        selectedYear = option.dataset.value;\n    });\n});\n\n// --- Dropdown dÄ±ÅŸÄ±na tÄ±klanÄ±nca kapanmasÄ± --- (TekrarÄ± KaldÄ±rÄ±ldÄ±)\ndocument.addEventListener('click', e => {\n    if (!selectBox.contains(e.target)) {\n        selectBox.classList.remove('open');\n        optionsContainer.style.display = 'none';\n    }\n});\n\n// Arama butonuna basÄ±ldÄ±ÄŸÄ±nda\nsearchBtn.addEventListener(\"click\", () => {\n    // Yeni bir arama baÅŸlatÄ±ldÄ±ÄŸÄ± iÃ§in 1. sayfadan yÃ¼kler.\n    handleMovieRequest(1); \n});\n\n// Enter ile arama\nsearchInput.addEventListener(\"keydown\", (e) => {\n    if (e.key === \"Enter\") {\n        e.preventDefault();\n        searchBtn.click();\n    }\n});\n\n// Clear butonuna basÄ±ldÄ±ÄŸÄ±nda\nclearBtn.addEventListener(\"click\", () => {\n    // Filtreleri sÄ±fÄ±rla\n    searchInput.value = \"\";\n    selectedYear = null;\n    selected.childNodes[0].textContent = \"Year\";\n    \n    // TÃ¼m seÃ§eneklerden selected'Ä± kaldÄ±r\n    optionsList.forEach(o => o.classList.remove('selected'));\n\n    // FiltrelenmiÅŸ varsayÄ±lan seÃ§eneÄŸi bul ve aktif yap\n    const defaultOption = Array.from(optionsList).find(o => o.dataset.value === undefined || o.textContent.trim() === \"2025\");\n    if (defaultOption) {\n        defaultOption.classList.add('selected');\n    }\n\n    // Filmleri listele (1. sayfadan baÅŸla)\n    handleMovieRequest(1);\n});\n\n// Sayfa deÄŸiÅŸtirme olay dinleyicisi (Ã–nceki butonsuz/SVG'siz mantÄ±ÄŸa gÃ¶re ayarlandÄ±)\npaginationContainer.addEventListener(\"click\", (e) => {\n    // Sadece numaralÄ± butona basÄ±ldÄ±ÄŸÄ±nda iÅŸlem yap\n    const button = e.target.closest(\".catalog-page-btn\");\n    if (!button) return;\n\n    let newPage = currentPage;\n    \n    // TÄ±klanan butondaki metni alÄ±yoruz\n    const buttonText = button.textContent.trim().replace(/^0+/, ''); \n\n    // BasÄ±lan butonun numara mÄ± (01, 02) yoksa ok (prev, next) mu olduÄŸunu kontrol ediyoruz\n    if (button.classList.contains(\"prev-btn\")) {\n        newPage = Math.max(1, currentPage - 1);\n    } else if (button.classList.contains(\"next-btn\")) {\n        // totalPages deÄŸiÅŸkenine eriÅŸimimiz olmadÄ±ÄŸÄ± iÃ§in bu kÄ±sÄ±m ÅŸu an tam Ã§alÄ±ÅŸmaz,\n        // ancak varsayÄ±lan olarak ilerlemeye izin verir. \n        newPage = currentPage + 1; \n    } else {\n        // NumaralÄ± buton\n        const pageNumber = parseInt(buttonText);\n        if (!isNaN(pageNumber)) {\n            newPage = pageNumber;\n        }\n    }\n    \n    // YalnÄ±zca yeni bir sayfa numarasÄ±na basÄ±ldÄ±ysa API'yi Ã§aÄŸÄ±r\n    if (newPage !== currentPage) {\n        handleMovieRequest(newPage); \n    }\n});\n\n\n// Kartlara tÄ±klandÄ±ÄŸÄ±nda modal aÃ§\ndocument.addEventListener('click', e => {\n    const card = e.target.closest('.catalog-movie-item');\n    if (card && card.dataset.movieId) {\n        openMovieModal(card.dataset.movieId);\n    }\n});\n\nhandleMovieRequest(1);"],"names":["genreMap","API_KEY","BASE_URL","IMAGE_BASE_URL","movieList","searchInput","searchBtn","clearBtn","paginationContainer","selectBox","selected","optionsContainer","optionsList","selectedYear","currentPage","loadGenres","g","err","createStarRating","vote_average","ratingOutOfFive","fullStars","halfStar","emptyStars","starsHTML","createMovieCard","movie","year","genres","id","poster","ratingStars","renderMovies","movies","updatePaginationButtons","page","button","buttonText","handleMovieRequest","query","url","params","res","isOpen","option","o","defaultOption","newPage","pageNumber","card","openMovieModal"],"mappings":"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"}
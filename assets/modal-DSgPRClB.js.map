{"version":3,"file":"modal-DSgPRClB.js","sources":["../../src/config.js","../../src/js/hero.js","../../src/js/modal.js"],"sourcesContent":["const config = {\n  TMDB_API_KEY: '532c164e7aaa985e6a97f7fc762d2aea',\n  TMDB_BASE_URL: 'https://api.themoviedb.org/3',\n  TMDB_IMAGE_BASE_URL: 'https://image.tmdb.org/t/p',\n};\n\nexport default config;\n","import config from '../config.js';\n\nconst API_KEY = config.TMDB_API_KEY;\nconst BASE_URL = config.TMDB_BASE_URL;\n\nasync function showRandomHeroMovie() {\n  try {\n    const res = await fetch(\n      `${BASE_URL}/trending/movie/week?api_key=${API_KEY}`\n    );\n    if (!res.ok) throw new Error(`API Hatası: ${res.status} ${res.statusText}`);\n\n    const data = await res.json();\n    const movies = data.results;\n    if (!movies || movies.length === 0) throw new Error('Film gelmedi');\n\n    const movie = movies[Math.floor(Math.random() * movies.length)];\n\n    const videoRes = await fetch(\n      `${BASE_URL}/movie/${movie.id}/videos?api_key=${API_KEY}`\n    );\n    const videoData = await videoRes.json();\n    const trailer = videoData.results?.find(\n      v => v.type === 'Trailer' && v.site === 'YouTube'\n    );\n\n    // DOM\n    document.getElementById('hero-default').style.display = 'none';\n    const heroRandom = document.getElementById('hero-random-movie');\n    heroRandom.style.display = 'flex';\n\n    if (movie.backdrop_path) {\n      heroRandom.style.backgroundImage = `url(https://image.tmdb.org/t/p/original${movie.backdrop_path})`;\n    }\n\n    heroRandom.querySelector('.hero-movie-title').textContent = movie.title;\n    heroRandom.querySelector('.hero-movie-details').textContent =\n      movie.overview || 'Açıklama yok.';\n\n    const poster = document.getElementById('hero-movie-poster');\n    poster.src = movie.poster_path\n      ? `https://image.tmdb.org/t/p/w500${movie.poster_path}`\n      : 'https://via.placeholder.com/500x750?text=No+Image';\n\n    // Yıldızlar\n    const starsContainer = heroRandom.querySelector('.hero-movie-stars');\n    starsContainer.innerHTML = '';\n\n    const rating = Math.round(movie.vote_average || 0);\n    const fullStars = Math.floor(rating / 2);\n    const halfStars = rating % 2 ? 1 : 0;\n    const emptyStars = 5 - fullStars - halfStars;\n\n    function getStarSVG(type) {\n      return `<svg class=\"star-icon\" width=\"14\" height=\"14\"><use href=\"#${type}-star\"></use></svg>`;\n    }\n\n    for (let i = 0; i < fullStars; i++)\n      starsContainer.innerHTML += getStarSVG('full');\n    for (let i = 0; i < halfStars; i++)\n      starsContainer.innerHTML += getStarSVG('half');\n    for (let i = 0; i < emptyStars; i++)\n      starsContainer.innerHTML += getStarSVG('empty');\n\n    // Trailer\n    const trailerBtn = document.getElementById('watch-trailer-btn');\n    if (trailerBtn && trailer) {\n      trailerBtn.onclick = () => {\n        const overlay = document.createElement('div');\n        overlay.className = 'movie-popup-overlay';\n        overlay.innerHTML = `\n          <div class=\"popup-video-wrapper\">\n            <iframe src=\"https://www.youtube.com/embed/${trailer.key}?autoplay=1\" allow=\"autoplay\" allowfullscreen></iframe>\n          </div>`;\n        document.body.appendChild(overlay);\n        overlay.onclick = () => overlay.remove();\n      };\n    }\n\n    document.getElementById('more-details-btn').onclick = () => {\n      if (typeof deleteHeroTrendsPopup === 'function')\n        deleteHeroTrendsPopup(movie);\n    };\n  } catch (err) {\n    console.error('Hero yüklenemedi:', err);\n    document.getElementById('hero-default').style.display = 'block';\n    document.getElementById('hero-random-movie').style.display = 'none';\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', showRandomHeroMovie);\n","import config from '../config.js';\n\nconsole.log('YENİ MODAL.JS YÜKLENDİ - ' + new Date().toLocaleTimeString());\nlet modal, closeBtn, libraryBtn;\n\n// Modal yüklendi mi diye sürekli kontrol eden fonksiyon\nfunction waitForModal() {\n  return new Promise(resolve => {\n    const check = () => {\n      modal = document.getElementById('movie-modal');\n      closeBtn = document.getElementById('modal-close-btn');\n      libraryBtn = document.getElementById('modal-library-btn');\n\n      if (modal && closeBtn && libraryBtn) {\n        setupModalEvents();\n        resolve();\n      } else {\n        requestAnimationFrame(check); // 60fps'de sürekli kontrol et\n      }\n    };\n    check();\n  });\n}\n\n// Modal event’lerini bir kere kur\nfunction setupModalEvents() {\n  closeBtn.addEventListener('click', closeModal);\n  modal.addEventListener('click', e => {\n    if (e.target.classList.contains('modal-backdrop')) closeModal();\n  });\n}\n\nfunction closeModal() {\n  modal.classList.remove('show');\n  document.body.style.overflow = '';\n  const wrapper = document.getElementById('modal-trailer-wrapper');\n  const iframe = document.getElementById('modal-trailer-iframe');\n  if (wrapper) wrapper.style.display = 'none';\n  if (iframe) iframe.src = '';\n}\n\n// Ana fonksiyon – artık her yerden güvenle çağırılabilir\nexport async function openMovieModal(movieId) {\n  console.log('openMovieModal çağrıldı, ID:', movieId); // ← BU LOG ÇOK ÖNEMLİ\n  await waitForModal(); // modal gelene kadar bekle\n\n  try {\n    const [movieRes, videoRes] = await Promise.all([\n      axios.get(\n        `${config.TMDB_BASE_URL}/movie/${movieId}?api_key=${config.TMDB_API_KEY}`\n      ),\n      axios.get(\n        `${config.TMDB_BASE_URL}/movie/${movieId}/videos?api_key=${config.TMDB_API_KEY}`\n      ),\n    ]);\n\n    const movie = movieRes.data;\n    const trailer = videoRes.data.results.find(\n      v => v.site === 'YouTube' && v.type === 'Trailer'\n    );\n\n    // Artık null olma ihtimali YOK\n    document.getElementById('modal-poster').src = movie.poster_path\n      ? `https://image.tmdb.org/t/p/w500${movie.poster_path}`\n      : './img/no-poster.jpg';\n\n    document.getElementById('modal-title').textContent = movie.title;\n    document.getElementById(\n      'modal-rating'\n    ).textContent = `${movie.vote_average.toFixed(1)} / ${movie.vote_count}`;\n    document.getElementById('modal-popularity').textContent = Math.round(\n      movie.popularity\n    );\n    document.getElementById('modal-release').textContent = formatDate(\n      movie.release_date\n    );\n    document.getElementById('modal-overview').textContent =\n      movie.overview || 'Açıklama yok.';\n\n    // Trailer gösterimi için kullanılan yapı\n    const trailerWrapper = document.getElementById('modal-trailer-wrapper');\n    const iframe = document.getElementById('modal-trailer-iframe');\n    if (trailer && trailerWrapper && iframe) {\n      trailerWrapper.style.display = 'block';\n      iframe.src = `https://www.youtube.com/embed/${trailer.key}?autoplay=1&rel=0`;\n    } else if (trailerWrapper) {\n      trailerWrapper.style.display = 'none';\n    }\n\n    // Kütüphaneye ekle butonu - addToLibrary ile birlikte localStorage içerisine verileri ekleyebildiğimiz bir sistem oluşturuyoruz.\n    libraryBtn.textContent = 'Add to my library';\n    libraryBtn.disabled = false;\n    libraryBtn.onclick = () => addToLibrary(movie);\n\n    modal.classList.add('show'); // flex’i aç\n    document.body.style.overflow = 'hidden';\n  } catch (err) {\n    console.error('Modal hatası:', err);\n    alert('Movie details could not be loaded!');\n  }\n}\n\nfunction formatDate(dateString) {\n  if (!dateString) return '—';\n  const months = [\n    'January',\n    'February',\n    'March',\n    'April',\n    'May',\n    'June',\n    'July',\n    'August',\n    'September',\n    'October',\n    'November',\n    'December',\n  ];\n  const d = new Date(dateString);\n  return `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;\n}\n\n// Add to my library fonksiyonu - LocalStorage içerisine mevcut filmlerin verilerini json oluşturup, oraya ekleyen bir yapı kuruldu.\nfunction addToLibrary(movie) {\n  const library = JSON.parse(localStorage.getItem('myMovieLibrary') || '[]');\n  if (library.some(m => m.id === movie.id)) {\n    alert('This movie is already in your library!');\n    return;\n  }\n  library.push(movie);\n  localStorage.setItem('myMovieLibrary', JSON.stringify(library));\n  alert(`${movie.title} added to your library.`);\n  libraryBtn.textContent = 'Added';\n  libraryBtn.disabled = true;\n}\n"],"names":["config","API_KEY","BASE_URL","showRandomHeroMovie","getStarSVG","type","res","movies","movie","trailer","_a","v","heroRandom","poster","starsContainer","rating","fullStars","halfStars","emptyStars","i","trailerBtn","overlay","err","modal","closeBtn","libraryBtn","waitForModal","resolve","check","setupModalEvents","closeModal","e","wrapper","iframe","openMovieModal","movieId","movieRes","videoRes","formatDate","trailerWrapper","addToLibrary","dateString","months","d","library","m"],"mappings":"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"}
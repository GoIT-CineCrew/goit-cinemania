import{o as T,c as d}from"./modal-C75sch9z.js";const I=d.TMDB_API_KEY,S=d.TMDB_BASE_URL;async function x(){var t;try{let w=function(o){return`<svg class="star-icon" width="14" height="14"><use href="#${o}-star"></use></svg>`};const r=await fetch(`${S}/trending/movie/week?api_key=${I}`);if(!r.ok)throw new Error(`API Hatası: ${r.status} ${r.statusText}`);const e=(await r.json()).results;if(!e||e.length===0)throw new Error("Film gelmedi");const i=e[Math.floor(Math.random()*e.length)],p=(t=(await(await fetch(`${S}/movie/${i.id}/videos?api_key=${I}`)).json()).results)==null?void 0:t.find(o=>o.site==="YouTube"&&(o.type==="Trailer"||o.type==="Teaser"||o.type==="Clip"));document.getElementById("hero-default").style.display="none";const m=document.getElementById("hero-random-movie");m.style.display="flex",i.backdrop_path&&(m.style.backgroundImage=`url[](https://image.tmdb.org/t/p/original${i.backdrop_path})`),m.querySelector(".hero-movie-title").textContent=i.title,m.querySelector(".hero-movie-details").textContent=i.overview||"Açıklama yok.";const _=document.getElementById("hero-movie-poster");_.src=i.poster_path?`https://image.tmdb.org/t/p/w500${i.poster_path}`:"https://via.placeholder.com/500x750?text=No+Image";const u=m.querySelector(".hero-movie-stars");u.innerHTML="";const E=Math.round(i.vote_average||0),f=Math.floor(E/2),h=E%2?1:0,g=5-f-h;for(let o=0;o<f;o++)u.innerHTML+=w("full");for(let o=0;o<h;o++)u.innerHTML+=w("half");for(let o=0;o<g;o++)u.innerHTML+=w("empty");const l=document.getElementById("trailer-modal"),c=document.getElementById("watch-trailer-btn"),M=l.querySelector(".trailer-close-btn"),k=l.querySelector(".trailer-content"),B=()=>{p&&(k.innerHTML=`
      <button class="trailer-close-btn" type="button">
        <svg><use href="./img/sprite.svg#close-mobile"></use></svg>
      </button>
      <iframe 
        src="https://www.youtube.com/embed/${p.key}?autoplay=1&rel=0&modestbranding=1"
        frameborder="0"
        allow="autoplay; encrypted-media; picture-in-picture"
        allowfullscreen
        style="position:absolute; top:0; left:0; width:100%; height:100%;">
      </iframe>
    `),l.style.display="block"},y=()=>{l.style.display="none",k.innerHTML=`
    <button class="trailer-close-btn" type="button">
      <svg><use href="./img/sprite.svg#close-mobile"></use></svg>
    </button>
    <p class="trailer-info">
      OOPS... <br />
      We are very sorry! <br />
      But we couldn’t find the trailer.
    </p>
    <img src="./img/Trailer-Error-Mobile.png" 
         srcset="./img/Trailer-Error-Desktop@2x.png 2x" 
         alt="Trailer not found" class="trailer-image">
  `};c.onclick=B,M.onclick=y,l.addEventListener("click",o=>{o.target===l&&y()}),document.addEventListener("keydown",o=>{o.key==="Escape"&&l.style.display==="block"&&y()}),c&&p?(c.style.cursor="pointer",c.disabled=!1,c.onclick=B):c&&(c.disabled=!0,c.style.cursor="not-allowed",c.title="Bu film için fragman bulunamadı"),M&&(M.onclick=y),l.addEventListener("click",o=>{o.target===l&&y()}),document.addEventListener("keydown",o=>{o.key==="Escape"&&l.style.display==="flex"&&y()}),document.getElementById("more-details-btn").onclick=()=>{if(!(i!=null&&i.id))return;const o=document.getElementById("modal-trailer-wrapper"),b=document.getElementById("modal-trailer-iframe");o&&(o.style.display="none"),b&&(b.src=""),T(i.id),setTimeout(()=>{o&&(o.style.display="none"),b&&(b.src="")},100)}}catch(r){console.error("Hero yüklenemedi:",r),document.getElementById("hero-default").style.display="block",document.getElementById("hero-random-movie").style.display="none"}}document.addEventListener("DOMContentLoaded",x);let v={};const $=d.TMDB_API_KEY,L=d.TMDB_BASE_URL,D=d.TMDB_IMAGE_BASE_URL;async function C(){if(!(Object.keys(v).length>0))try{(await axios.get(`${L}/genre/movie/list?api_key=${$}`)).data.genres.forEach(r=>{v[r.id]=r.name}),console.log("Genres loaded:",v)}catch(t){console.error("Genres couldn't loaded:",t)}}async function R(){try{return(await axios.get(`${L}/trending/movie/week?api_key=${$}`)).data.results}catch(t){return console.error("API hatası:",t),[]}}function q(t){const r=t/2,n=Math.floor(r),e=r-n>=.5?1:0,i=5-n-e;let a="";for(let s=0;s<n;s++)a+=`<li>
        <svg width="14" height="14">
            <use href="./img/sprite.svg#full-star"></use>
        </svg>
    </li>`;e&&(a+='<li><svg width="14" height="14"><use href="./img/sprite.svg#half-star"></use></svg></li>');for(let s=0;s<i;s++)a+='<li><svg width="14" height="14"><use href="./img/sprite.svg#empty-star"></use></svg></li>';return a}async function P(){console.log("Anasayfa yüklendi, API'den veri çekiliyor..."),await C();const t=await R();if(console.log("Movies list"+JSON.stringify(t.map(e=>e.title))),await H(),t.length===0)return;const r=t.slice(0,3),n=document.querySelectorAll(".home-movie-item");r.forEach((e,i)=>{const a=n[i];if(!a)return;const s=a.querySelector(".card-title");s&&(s.textContent=e.title||e.name);const p=e.release_date?e.release_date.split("-")[0]:"—",m=a.querySelector(".card-year");m&&(m.textContent=p);const _=e.poster_path?`${D}/w342${e.poster_path}`:"./img/no-poster.jpg",u=a.querySelector(".card-image");u&&(u.src=_,u.alt=`${e.title} poster`);const E=e.genre_ids.slice(0,2).map(g=>v[g]||"Bilinmiyor").join(", "),f=a.querySelector(".card-genre");f&&(f.textContent=E||"No genres");const h=a.querySelector(".card-rating");h&&(h.innerHTML=q(e.vote_average)),a.style.cursor="pointer",a.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),console.log("Karta tıklandı, ID:",e.id),T(e.id)})}),console.log("3 kart başarıyla dolduruldu!")}async function H(){try{const t=await axios.get(`${d.TMDB_BASE_URL}/movie/upcoming?api_key=${d.TMDB_API_KEY}&page=1`),r=new Date().toISOString().split("T")[0],n=t.data.results.filter(s=>s.release_date>=r);if(n.length===0){console.log("There are no upcoming movies this month!");return}const e=n[Math.floor(Math.random()*n.length)];document.getElementById("upcoming-poster").src=e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:"./img/no-poster.jpg",document.getElementById("upcoming-title").textContent=e.title,document.getElementById("upcoming-release").textContent=e.release_date?U(e.release_date):"—",document.getElementById("upcoming-vote").textContent=e.vote_average.toFixed(1),document.getElementById("upcoming-votes").textContent=e.vote_count,document.getElementById("upcoming-popularity").textContent=Math.round(e.popularity);const i=e.genre_ids.slice(0,2).map(s=>v[s]||"Bilinmiyor").join(", ");document.getElementById("upcoming-genre").textContent=i,console.log("Film Açıklaması"+e.overview),document.getElementById("upcoming-overview-content").querySelector("p").textContent=e.overview||"Movie overview couldn't find!",console.log("Upcoming movie yüklendi:",e.title);const a=document.getElementById("upcoming-library-btn");a.dataset.movieId=e.id}catch(t){console.error("Upcoming movie yüklenemedi",t)}}function U(t){const r=["January","February","March","April","May","June","July","August","September","October","November","December"],n=new Date(t);return`${n.getDate()} ${r[n.getMonth()]} ${n.getFullYear()}`}const A="myMovieLibrary";function O(){return JSON.parse(localStorage.getItem(A))||[]}function Y(t){const r=O();r.find(n=>n.id===t.id)?alert("This movie is already in your library!"):(r.push(t),localStorage.setItem(A,JSON.stringify(r)),alert(`${t.title} added to your library.`))}document.addEventListener("click",async function(t){if(t.target.id==="upcoming-library-btn"||t.target.classList.contains("card-library-btn")){const r=t.target.dataset.movieId;if(!r)return;try{const n=await axios.get(`${d.TMDB_BASE_URL}/movie/${r}?api_key=${d.TMDB_API_KEY}`);Y(n.data),t.target.textContent="Remove from my library",t.target.disabled=!0}catch{alert("An error occurred while adding the movie.")}}});document.addEventListener("DOMContentLoaded",P);
//# sourceMappingURL=home-BAFl-bYO.js.map

{"version":3,"file":"catalog-D2mMQ0OU.js","sources":["../../src/catalog.js"],"sourcesContent":["import { openMovieModal } from './js/modal.js';\n\nconst genreMap = {};\n// ---- API CONFIG ----\nconst API_KEY = 'aaf24ac7ab7c5211361a71263e777bb9';\nconst BASE_URL = 'https://api.themoviedb.org/3';\nconst IMAGE_BASE_URL = 'https://image.tmdb.org/t/p/w500';\n\n// ---- DOM ELEMENTS ----\nconst movieList = document.querySelector('.catalog-movie-items');\nconst searchInput = document.querySelector('.catalog-search input');\nconst searchBtn = document.querySelector('.search-icon');\nconst clearBtn = document.querySelector('.clear-button');\nconst yearFilterOptions = document.querySelectorAll(\n  '.catalog-dropdown-filter .option'\n);\nlet selectedYear = null;\n\n// ---- DROPDOWN ----\nconst selectBox = document.querySelector('.catalog-dropdown-filter');\nconst selected = selectBox.querySelector('.selected');\nconst optionsContainer = selectBox.querySelector('.options');\nconst optionsList = selectBox.querySelectorAll('.option');\n\n// --- Dropdown aç/kapa ---\nselected.addEventListener('click', () => {\n  const isOpen = selectBox.classList.toggle('open');\n  optionsContainer.style.display = isOpen ? 'block' : 'none';\n});\n\n// ---- yıl seçimi ----\nyearFilterOptions.forEach(option => {\n  option.addEventListener('click', () => {\n    selected.childNodes[0].textContent = option.textContent;\n    selectedYear = option.dataset.value || null;\n    selectBox.classList.remove('open');\n    optionsContainer.style.display = 'none';\n  });\n});\n\n// --- Dropdown dışına tıklanınca kapanması ---\ndocument.addEventListener('click', e => {\n  if (!selectBox.contains(e.target)) {\n    selectBox.classList.remove('open');\n    optionsContainer.style.display = 'none';\n  }\n});\n\n// genresleri apiden çekme\nasync function loadGenres() {\n  if (Object.keys(genreMap).length > 0) return; // zaten yüklüyse tekrar çekme\n\n  try {\n    const response = await axios.get(`${BASE_URL}/genre/movie/list`, {\n      params: { api_key: API_KEY, language: 'en-US' },\n    });\n    response.data.genres.forEach(g => {\n      genreMap[g.id] = g.name;\n    });\n  } catch (err) {\n    console.error('Türler yüklenemedi:', err);\n  }\n}\n\n// Yıldızlar\nfunction createStarRating(vote_average) {\n  const rating = vote_average || 0;\n  const score = rating / 2;\n  const full = Math.floor(score);\n  const half = score - full >= 0.5 ? 1 : 0;\n  const empty = 5 - full - half;\n  let html = '';\n  for (let i = 0; i < full; i++)\n    html += `<li><svg width=\"14\" height=\"14\"><use href=\"./img/sprite.svg#full-star\"></use></svg></li>`;\n  if (half)\n    html += `<li><svg width=\"14\" height=\"14\"><use href=\"./img/sprite.svg#half-star\"></use></svg></li>`;\n  for (let i = 0; i < empty; i++)\n    html += `<li><svg width=\"14\" height=\"14\"><use href=\"./img/sprite.svg#empty-star\"></use></svg></li>`;\n  return html;\n}\n\n// ---- film kartları html yapısında oluşturma ----\nfunction createMovieCard(movie) {\n  // ratingi hesaplanamıyosa\n  const year = movie.release_date ? movie.release_date.slice(0, 4) : 'N/A';\n  // genreye sahip değilse\n  const genres =\n    movie.genre_ids\n      ?.map(id => genreMap[id])\n      .filter(Boolean)\n      .join(', ') || 'Unknown';\n  const poster = movie.poster_path\n    ? `${IMAGE_BASE_URL}${movie.poster_path}`\n    : './img/no-poster.jpg';\n\n  return `\n    <li class=\"catalog-movie-item\" data-movie-id=\"${movie.id}\">\n      <section class=\"card\" style=\"cursor: pointer;\">\n        <img class=\"card-image\" src=\"${poster}\" alt=\"${\n    movie.title\n  }\" loading=\"lazy\" />\n        <div class=\"card-content\">\n          <h2 class=\"card-title\">${movie.title}</h2>\n          <p class=\"card-info\">\n            <span class=\"card-genre\">${genres}</span> |\n            <span class=\"card-year\">${year}</span>\n          </p>\n          <ul class=\"card-rating\">${createStarRating(movie.vote_average)}</ul>\n        </div>\n      </section>\n    </li>\n  `;\n}\n\n// ---- filmleri renferla ----\nfunction renderMovies(movies) {\n  movieList.innerHTML = '';\n  movies.forEach(movie => {\n    if (!movie.poster_path) return;\n    movieList.insertAdjacentHTML('beforeend', createMovieCard(movie));\n  });\n}\n\n// --- Bir seçenek seçildiğinde ---\noptionsList.forEach(option => {\n  option.addEventListener('click', () => {\n    // sadece text'i değiştir\n    selected.childNodes[0].textContent = option.textContent;\n\n    // seçili class'ı güncelle\n    optionsList.forEach(o => o.classList.remove('selected'));\n    option.classList.add('selected');\n\n    // menüyü kapat\n    selectBox.classList.remove('open');\n    optionsContainer.style.display = 'none';\n  });\n});\n\n// ---- popüler filmleri getir ----\nasync function getMovies(page = 1) {\n  try {\n    await loadGenres(); // önce türleri yükle\n    const res = await axios.get(`${BASE_URL}/movie/popular`, {\n      params: { api_key: API_KEY, language: 'en-US', page },\n    });\n    renderMovies(res.data.results);\n  } catch (err) {\n    console.error('API Hatası:', err);\n  }\n}\n\n// ---- film arama yıl filtresi ile ----\nasync function searchMovies(query, year = null) {\n  try {\n    const params = {\n      api_key: API_KEY,\n      language: 'en-US',\n      query: query,\n    };\n    if (year) params.primary_release_year = year;\n\n    const res = await axios.get(`${BASE_URL}/search/movie`, { params });\n    renderMovies(res.data.results);\n  } catch (err) {\n    console.error('Arama hatası:', err);\n  }\n}\n\n// ----yıla göre film ----\nasync function getMoviesByYear(year) {\n  try {\n    const res = await axios.get(`${BASE_URL}/discover/movie`, {\n      params: {\n        api_key: API_KEY,\n        language: 'en-US',\n        sort_by: 'popularity.desc',\n        primary_release_year: year,\n      },\n    });\n    renderMovies(res.data.results);\n  } catch (err) {\n    console.error('Yıl filtre hatası:', err);\n  }\n}\n\n// ---- arama butonuyla arama ----\nsearchBtn.addEventListener('click', () => {\n  const query = searchInput.value.trim();\n\n  if (query) {\n    // arama + yıl filtresi\n    searchMovies(query, selectedYear);\n  } else if (selectedYear) {\n    // yalnızca yıl filtresi\n    getMoviesByYear(selectedYear);\n  } else {\n    // hiçbir filtre yoksa popüler filmler\n    getMovies();\n  }\n});\n\n// Enter ile arama\n\nsearchInput.addEventListener('keydown', e => {\n  if (e.key === 'Enter') {\n    e.preventDefault(); // form submit vs. engelle\n    searchBtn.click(); // Search butonuna tıklamış gibi çalıştır\n  }\n});\n\nclearBtn.addEventListener('click', () => {\n  // inputu temizle\n  searchInput.value = '';\n\n  // seçili yılı sıfırla\n  selectedYear = null;\n\n  // dropdown daki selected kısmı\n  selected.childNodes[0].textContent = 'Year';\n\n  // tüm seçeneklerden selectedı kaldır\n  optionsList.forEach(o => o.classList.remove('selected'));\n\n  // Year seçeneğine selected class ekle\n  const defaultOption = Array.from(optionsList).find(\n    o => o.dataset.value === undefined || o.textContent === 'Year'\n  );\n  if (defaultOption) {\n    defaultOption.classList.add('selected');\n  }\n\n  // filmleri listele\n  getMovies();\n});\n\n// Kartlara tıklandığında modal aç\ndocument.addEventListener('click', e => {\n  const card = e.target.closest('.catalog-movie-item');\n  if (card && card.dataset.movieId) {\n    openMovieModal(card.dataset.movieId);\n  }\n});\n\n// ---- SAYFA AÇILDIĞINDA POPÜLER FİLMLER ----\ngetMovies();\n"],"names":["genreMap","API_KEY","BASE_URL","IMAGE_BASE_URL","movieList","searchInput","searchBtn","clearBtn","yearFilterOptions","selectedYear","selectBox","selected","optionsContainer","optionsList","isOpen","option","loadGenres","g","err","createStarRating","vote_average","score","full","half","empty","html","i","createMovieCard","movie","year","genres","_a","id","poster","renderMovies","movies","o","getMovies","page","res","searchMovies","query","params","getMoviesByYear","defaultOption","card","openMovieModal"],"mappings":"wCAEA,MAAMA,EAAW,CAAA,EAEXC,EAAU,mCACVC,EAAW,+BACXC,EAAiB,kCAGjBC,EAAY,SAAS,cAAc,sBAAsB,EACzDC,EAAc,SAAS,cAAc,uBAAuB,EAC5DC,EAAY,SAAS,cAAc,cAAc,EACjDC,EAAW,SAAS,cAAc,eAAe,EACjDC,EAAoB,SAAS,iBACjC,kCACF,EACA,IAAIC,EAAe,KAGnB,MAAMC,EAAY,SAAS,cAAc,0BAA0B,EAC7DC,EAAWD,EAAU,cAAc,WAAW,EAC9CE,EAAmBF,EAAU,cAAc,UAAU,EACrDG,EAAcH,EAAU,iBAAiB,SAAS,EAGxDC,EAAS,iBAAiB,QAAS,IAAM,CACvC,MAAMG,EAASJ,EAAU,UAAU,OAAO,MAAM,EAChDE,EAAiB,MAAM,QAAUE,EAAS,QAAU,MACtD,CAAC,EAGDN,EAAkB,QAAQO,GAAU,CAClCA,EAAO,iBAAiB,QAAS,IAAM,CACrCJ,EAAS,WAAW,CAAC,EAAE,YAAcI,EAAO,YAC5CN,EAAeM,EAAO,QAAQ,OAAS,KACvCL,EAAU,UAAU,OAAO,MAAM,EACjCE,EAAiB,MAAM,QAAU,MACrC,CAAG,CACH,CAAC,EAGD,SAAS,iBAAiB,QAAS,GAAK,CACjCF,EAAU,SAAS,EAAE,MAAM,IAC9BA,EAAU,UAAU,OAAO,MAAM,EACjCE,EAAiB,MAAM,QAAU,OAErC,CAAC,EAGD,eAAeI,GAAa,CAC1B,GAAI,SAAO,KAAKhB,CAAQ,EAAE,OAAS,GAEnC,GAAI,EACe,MAAM,MAAM,IAAI,GAAGE,CAAQ,oBAAqB,CAC/D,OAAQ,CAAE,QAASD,EAAS,SAAU,OAAS,CACrD,CAAK,GACQ,KAAK,OAAO,QAAQgB,GAAK,CAChCjB,EAASiB,EAAE,EAAE,EAAIA,EAAE,IACzB,CAAK,CACF,OAAQC,EAAK,CACZ,QAAQ,MAAM,sBAAuBA,CAAG,CACzC,CACH,CAGA,SAASC,EAAiBC,EAAc,CAEtC,MAAMC,GADSD,GAAgB,GACR,EACjBE,EAAO,KAAK,MAAMD,CAAK,EACvBE,EAAOF,EAAQC,GAAQ,GAAM,EAAI,EACjCE,EAAQ,EAAIF,EAAOC,EACzB,IAAIE,EAAO,GACX,QAASC,EAAI,EAAGA,EAAIJ,EAAMI,IACxBD,GAAQ,2FACNF,IACFE,GAAQ,4FACV,QAASC,EAAI,EAAGA,EAAIF,EAAOE,IACzBD,GAAQ,4FACV,OAAOA,CACT,CAGA,SAASE,EAAgBC,EAAO,OAE9B,MAAMC,EAAOD,EAAM,aAAeA,EAAM,aAAa,MAAM,EAAG,CAAC,EAAI,MAE7DE,IACJC,EAAAH,EAAM,YAAN,YAAAG,EACI,IAAIC,GAAMhC,EAASgC,CAAE,GACtB,OAAO,SACP,KAAK,QAAS,UACbC,EAASL,EAAM,YACjB,GAAGzB,CAAc,GAAGyB,EAAM,WAAW,GACrC,sBAEJ,MAAO;AAAA,oDAC2CA,EAAM,EAAE;AAAA;AAAA,uCAErBK,CAAM,UACzCL,EAAM,KACP;AAAA;AAAA,mCAEgCA,EAAM,KAAK;AAAA;AAAA,uCAEPE,CAAM;AAAA,sCACPD,CAAI;AAAA;AAAA,oCAENV,EAAiBS,EAAM,YAAY,CAAC;AAAA;AAAA;AAAA;AAAA,GAKxE,CAGA,SAASM,EAAaC,EAAQ,CAC5B/B,EAAU,UAAY,GACtB+B,EAAO,QAAQP,GAAS,CACjBA,EAAM,aACXxB,EAAU,mBAAmB,YAAauB,EAAgBC,CAAK,CAAC,CACpE,CAAG,CACH,CAGAf,EAAY,QAAQE,GAAU,CAC5BA,EAAO,iBAAiB,QAAS,IAAM,CAErCJ,EAAS,WAAW,CAAC,EAAE,YAAcI,EAAO,YAG5CF,EAAY,QAAQuB,GAAKA,EAAE,UAAU,OAAO,UAAU,CAAC,EACvDrB,EAAO,UAAU,IAAI,UAAU,EAG/BL,EAAU,UAAU,OAAO,MAAM,EACjCE,EAAiB,MAAM,QAAU,MACrC,CAAG,CACH,CAAC,EAGD,eAAeyB,EAAUC,EAAO,EAAG,CACjC,GAAI,CACF,MAAMtB,EAAU,EAChB,MAAMuB,EAAM,MAAM,MAAM,IAAI,GAAGrC,CAAQ,iBAAkB,CACvD,OAAQ,CAAE,QAASD,EAAS,SAAU,QAAS,KAAAqC,CAAM,CAC3D,CAAK,EACDJ,EAAaK,EAAI,KAAK,OAAO,CAC9B,OAAQrB,EAAK,CACZ,QAAQ,MAAM,cAAeA,CAAG,CACjC,CACH,CAGA,eAAesB,EAAaC,EAAOZ,EAAO,KAAM,CAC9C,GAAI,CACF,MAAMa,EAAS,CACb,QAASzC,EACT,SAAU,QACV,MAAOwC,CACb,EACQZ,IAAMa,EAAO,qBAAuBb,GAExC,MAAMU,EAAM,MAAM,MAAM,IAAI,GAAGrC,CAAQ,gBAAiB,CAAE,OAAAwC,CAAM,CAAE,EAClER,EAAaK,EAAI,KAAK,OAAO,CAC9B,OAAQrB,EAAK,CACZ,QAAQ,MAAM,gBAAiBA,CAAG,CACnC,CACH,CAGA,eAAeyB,EAAgBd,EAAM,CACnC,GAAI,CACF,MAAMU,EAAM,MAAM,MAAM,IAAI,GAAGrC,CAAQ,kBAAmB,CACxD,OAAQ,CACN,QAASD,EACT,SAAU,QACV,QAAS,kBACT,qBAAsB4B,CACvB,CACP,CAAK,EACDK,EAAaK,EAAI,KAAK,OAAO,CAC9B,OAAQrB,EAAK,CACZ,QAAQ,MAAM,qBAAsBA,CAAG,CACxC,CACH,CAGAZ,EAAU,iBAAiB,QAAS,IAAM,CACxC,MAAMmC,EAAQpC,EAAY,MAAM,KAAI,EAEhCoC,EAEFD,EAAaC,EAAOhC,CAAY,EACvBA,EAETkC,EAAgBlC,CAAY,EAG5B4B,GAEJ,CAAC,EAIDhC,EAAY,iBAAiB,UAAW,GAAK,CACvC,EAAE,MAAQ,UACZ,EAAE,eAAc,EAChBC,EAAU,MAAK,EAEnB,CAAC,EAEDC,EAAS,iBAAiB,QAAS,IAAM,CAEvCF,EAAY,MAAQ,GAGpBI,EAAe,KAGfE,EAAS,WAAW,CAAC,EAAE,YAAc,OAGrCE,EAAY,QAAQuB,GAAKA,EAAE,UAAU,OAAO,UAAU,CAAC,EAGvD,MAAMQ,EAAgB,MAAM,KAAK/B,CAAW,EAAE,KAC5CuB,GAAKA,EAAE,QAAQ,QAAU,QAAaA,EAAE,cAAgB,MAC5D,EACMQ,GACFA,EAAc,UAAU,IAAI,UAAU,EAIxCP,GACF,CAAC,EAGD,SAAS,iBAAiB,QAAS,GAAK,CACtC,MAAMQ,EAAO,EAAE,OAAO,QAAQ,qBAAqB,EAC/CA,GAAQA,EAAK,QAAQ,SACvBC,EAAeD,EAAK,QAAQ,OAAO,CAEvC,CAAC,EAGDR,EAAW"}
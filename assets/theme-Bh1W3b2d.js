(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}})();const f={TMDB_API_KEY:"532c164e7aaa985e6a97f7fc762d2aea",TMDB_BASE_URL:"https://api.themoviedb.org/3",TMDB_IMAGE_BASE_URL:"https://image.tmdb.org/t/p"};let h,E,c;function x(){return new Promise(r=>{const t=()=>{h=document.getElementById("movie-modal"),E=document.getElementById("modal-close-btn"),c=document.getElementById("modal-library-btn"),h&&E&&c?(P(),r()):requestAnimationFrame(t)};t()})}function P(){E.addEventListener("click",M),h.addEventListener("click",r=>{r.target.classList.contains("modal-backdrop")&&M()})}function M(){h.classList.remove("show"),document.body.style.overflow="";const r=document.getElementById("modal-trailer-wrapper"),t=document.getElementById("modal-trailer-iframe");r&&(r.style.display="none"),t&&(t.src="")}async function O(r){await x();try{const[t,e]=await Promise.all([axios.get(`${f.TMDB_BASE_URL}/movie/${r}?api_key=${f.TMDB_API_KEY}`),axios.get(`${f.TMDB_BASE_URL}/movie/${r}/videos?api_key=${f.TMDB_API_KEY}`)]),o=t.data,n=e.data.results.find(d=>d.site==="YouTube"&&d.type==="Trailer");document.getElementById("modal-poster").src=o.poster_path?`https://image.tmdb.org/t/p/w500${o.poster_path}`:"./img/no-poster.jpg",document.getElementById("modal-title").textContent=o.title,document.getElementById("modal-vote").textContent=o.vote_average.toFixed(1),document.getElementById("modal-votes").textContent=o.vote_count,document.getElementById("modal-popularity").textContent=Math.round(o.popularity);const a=document.getElementById("modal-genre");if(o.genres&&o.genres.length>0){const d=o.genres.map(u=>u.name),l=window.innerWidth<768?2:3;if(d.length<=l)a.textContent=d.join(", ");else{const u=d.slice(0,l).join(", "),p=d.length-l;a.textContent=`${u} +${p}`,a.title=d.join(", ")}}else a.textContent="—";document.getElementById("modal-overview").textContent=o.overview||"Açıklama yok.";const s=document.getElementById("modal-trailer-wrapper"),i=document.getElementById("modal-trailer-iframe");n&&s&&i?(s.style.display="block",i.src=`https://www.youtube.com/embed/${n.key}?autoplay=1&rel=0`):s&&(s.style.display="none"),D(o)?(c.textContent="Remove from library",c.disabled=!1,c.onclick=()=>T(o)):(c.textContent="Add to my library",c.disabled=!1,c.onclick=()=>B(o)),h.classList.add("show"),document.body.style.overflow="hidden"}catch(t){console.error("Modal hatası:",t),alert("Movie details could not be loaded!")}}function B(r){const t=JSON.parse(localStorage.getItem("myMovieLibrary")||"[]");if(t.some(e=>e.id===r.id)){alert("This movie is already in your library!");return}t.push(r);try{localStorage.setItem("myMovieLibrary",JSON.stringify(t)),alert(`${r.title} added to your library.`),c.textContent="Remove from library",c.disabled=!1,c.onclick=()=>T(r)}catch(e){console.error("Local storage'a kaydetme hatası:",e),alert("Filmi eklerken bir sorun oluştu.")}}function D(r){return JSON.parse(localStorage.getItem("myMovieLibrary")||"[]").some(e=>e.id===r.id)}function T(r){const e=JSON.parse(localStorage.getItem("myMovieLibrary")||"[]").filter(o=>o.id!==r.id);try{localStorage.setItem("myMovieLibrary",JSON.stringify(e)),alert(`${r.title} kütüphanenizden kaldırıldı.`),c.textContent="Add to my library",c.disabled=!1,c.onclick=()=>B(r)}catch(o){console.error("Local storage'dan silme hatası:",o),alert("Kaldırılırken bir sorun oluştu.")}}const L=f.TMDB_API_KEY,w=f.TMDB_BASE_URL;function q(r){const t=r/2,e=Math.floor(t),o=t-e>=.5,n=5-e-(o?1:0);let a="";for(let s=0;s<e;s++)a+='<li><svg class="star-svg"><use href="./img/sprite.svg#full-star"></use></svg></li>';o&&(a+='<li><svg class="star-svg"><use href="./img/sprite.svg#half-star"></use></svg></li>');for(let s=0;s<n;s++)a+='<li><svg class="star-svg"><use href="./img/sprite.svg#empty-star"></use></svg></li>';return a}async function C(){try{const r=localStorage.getItem("myMovieLibrary");if(!r)return null;const t=JSON.parse(r);if(!Array.isArray(t)||t.length===0)return null;const e=t[Math.floor(Math.random()*t.length)],o=typeof e=="number"?e:e.id;if(!o)return null;const n=await fetch(`${w}/movie/${o}?api_key=${L}&append_to_response=videos`);return n.ok?await n.json():null}catch(r){return console.error("Kütüphaneden film çekilemedi:",r),null}}function N(r,t=20){const e=r.trim().split(/\s+/);return e.length<=t?r:e.slice(0,t).join(" ")+"..."}async function R(){var n,a;const r=document.getElementById("hero-default"),t=document.getElementById("hero-random-movie");if(!t||t.dataset.heroLoaded==="true")return;let e=null,o=null;try{if(document.querySelector('[data-hero-mode="library"]')&&(e=await C()),!e){const m=await fetch(`${w}/trending/movie/week?api_key=${L}`);if(!m.ok)throw new Error("API Hatası");const b=await m.json();e=b.results[Math.floor(Math.random()*b.results.length)]}(n=e.videos)!=null&&n.results?o=e.videos.results.find(m=>m.site==="YouTube"&&["Trailer","Teaser","Clip"].includes(m.type)):o=(a=(await(await fetch(`${w}/movie/${e.id}/videos?api_key=${L}`)).json()).results)==null?void 0:a.find(I=>I.site==="YouTube"&&["Trailer","Teaser","Clip"].includes(I.type)),r.style.display="none",t.style.display="flex",t.querySelector(".hero-movie-title").textContent=e.title;const i=t.querySelector(".hero-movie-details"),y=e.overview||"Açıklama yok.";i.textContent=N(y,20),y.split(/\s+/).length>20&&(i.title=y),t.querySelector(".hero-movie-stars").innerHTML=`
      <ul class="card-rating hero-rating">${q(e.vote_average)}</ul>
    `;const d=t.querySelector(".hero-movie-poster-crop"),g=e.backdrop_path?`https://image.tmdb.org/t/p/original${e.backdrop_path}`:e.poster_path?`https://image.tmdb.org/t/p/w1280${e.poster_path}`:"./img/no-poster.jpg";d.style.backgroundImage=`url(${g})`;const l=document.getElementById("trailer-modal"),u=document.getElementById("watch-trailer-btn"),p=l.querySelector(".trailer-content"),$=()=>{o&&(p.innerHTML=`
          <button class="trailer-close-btn" type="button">
            <svg><use href="./img/sprite.svg#close-mobile"></use></svg>
          </button>
          <iframe src="https://www.youtube.com/embed/${o.key}?autoplay=1&rel=0" 
                  allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe>
        `),l.style.display="block"},v=()=>{l.style.display="none",p.innerHTML=`
        <button class="trailer-close-btn" type="button">
          <svg><use href="./img/sprite.svg#close-mobile"></use></svg>
        </button>
        <p class="trailer-info">OOPS...<br>We are very sorry!<br>But we couldn’t find the trailer.</p>
        <img src="./img/Trailer-Error-Mobile.png" srcset="./img/Trailer-Error-Desktop@2x.png 2x" alt="Trailer not found" class="trailer-image">
      `};u.onclick=$,l.querySelector(".trailer-close-btn").onclick=v,l.onclick=m=>m.target===l&&v(),document.addEventListener("keydown",m=>m.key==="Escape"&&l.style.display==="block"&&v()),document.getElementById("more-details-btn").onclick=async()=>{await O(e.id)},t.dataset.heroLoaded="true"}catch(s){console.error("Hero yüklenemedi:",s),r.style.display="block",t.style.display="none"}}function k(){const r=document.getElementById("hero-random-movie"),t=document.getElementById("hero-default");!r||!t||r.dataset.heroLoaded!=="true"&&R().then(()=>{r.dataset.heroLoaded="true"})}const S=new MutationObserver(r=>{r.forEach(t=>{t.addedNodes.forEach(e=>{var o;e.nodeType===1&&(e.id==="hero-random-movie"||(o=e.querySelector)!=null&&o.call(e,"#hero-random-movie"))&&k()})})});document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{S.observe(document.body,{childList:!0,subtree:!0}),k()}):(S.observe(document.body,{childList:!0,subtree:!0}),k());window.setActiveNavLink=function(){setTimeout(()=>{const r=location.pathname.split("/").pop()||"index.html";document.querySelectorAll("a[href]").forEach(e=>{let o=e.getAttribute("href")||"";if(o=o.replace(/^\.?\//,""),o===r||(r==="index.html"||r===""||r==="home.html")&&(o==="home.html"||o==="index.html")){e.classList.add("active");const i=e.closest("li");i&&i.classList.add("active")}else{e.classList.remove("active");const i=e.closest("li");i&&i.classList.remove("active")}})},100)};document.addEventListener("DOMContentLoaded",window.setActiveNavLink);document.addEventListener("load:partial",window.setActiveNavLink);document.addEventListener("DOMContentLoaded",()=>{const r=setInterval(()=>{document.querySelector(".header-nav-link")&&(window.setActiveNavLink(),clearInterval(r))},200)});const _=document.querySelectorAll(".theme-toggle-btn"),A=r=>{document.documentElement.dataset.theme=r,localStorage.setItem("theme",r),document.querySelectorAll(".theme-toggle-btn").forEach(t=>{t.style.transform="scale(0.9)",setTimeout(()=>t.style.transform="",200)}),_.forEach(t=>{var s,i,y,d,g,l,u,p;const e=t.querySelector('[href$="moon"]'),o=t.querySelector('[href$="sun"]'),n=t.querySelector('[href*="moon-circle"]'),a=t.querySelector('[href*="sun-circle"]');r==="light"?((s=e==null?void 0:e.parentElement)==null||s.style.setProperty("display","none"),(i=o==null?void 0:o.parentElement)==null||i.style.removeProperty("display"),(y=n==null?void 0:n.parentElement)==null||y.style.setProperty("display","none"),(d=a==null?void 0:a.parentElement)==null||d.style.removeProperty("display")):((g=e==null?void 0:e.parentElement)==null||g.style.removeProperty("display"),(l=o==null?void 0:o.parentElement)==null||l.style.setProperty("display","none"),(u=n==null?void 0:n.parentElement)==null||u.style.removeProperty("display"),(p=a==null?void 0:a.parentElement)==null||p.style.setProperty("display","none"))})};_.forEach(r=>{r.addEventListener("click",()=>{const e=(document.documentElement.dataset.theme||"dark")==="dark"?"light":"dark";A(e)})});document.addEventListener("DOMContentLoaded",()=>{const r=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches,e=r||(t?"dark":"light");e&&(document.documentElement.dataset.theme=e),A(document.documentElement.dataset.theme||"dark")});export{f as c,O as o};
//# sourceMappingURL=theme-Bh1W3b2d.js.map

(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=e(n);fetch(n.href,s)}})();const p={TMDB_API_KEY:"532c164e7aaa985e6a97f7fc762d2aea",TMDB_BASE_URL:"https://api.themoviedb.org/3",TMDB_IMAGE_BASE_URL:"https://image.tmdb.org/t/p"};console.log("YENİ MODAL.JS YÜKLENDİ - "+new Date().toLocaleTimeString());let h,E,u;function A(){return new Promise(o=>{const t=()=>{h=document.getElementById("movie-modal"),E=document.getElementById("modal-close-btn"),u=document.getElementById("modal-library-btn"),h&&E&&u?($(),o()):requestAnimationFrame(t)};t()})}function $(){E.addEventListener("click",B),h.addEventListener("click",o=>{o.target.classList.contains("modal-backdrop")&&B()})}function B(){h.classList.remove("show"),document.body.style.overflow="";const o=document.getElementById("modal-trailer-wrapper"),t=document.getElementById("modal-trailer-iframe");o&&(o.style.display="none"),t&&(t.src="")}async function x(o){console.log("openMovieModal çağrıldı, ID:",o),await A();try{const[t,e]=await Promise.all([axios.get(`${p.TMDB_BASE_URL}/movie/${o}?api_key=${p.TMDB_API_KEY}`),axios.get(`${p.TMDB_BASE_URL}/movie/${o}/videos?api_key=${p.TMDB_API_KEY}`)]),r=t.data,n=e.data.results.find(l=>l.site==="YouTube"&&l.type==="Trailer");document.getElementById("modal-poster").src=r.poster_path?`https://image.tmdb.org/t/p/w500${r.poster_path}`:"./img/no-poster.jpg",document.getElementById("modal-title").textContent=r.title,document.getElementById("modal-vote").textContent=r.vote_average.toFixed(1),document.getElementById("modal-votes").textContent=r.vote_count,document.getElementById("modal-popularity").textContent=Math.round(r.popularity);const s=document.getElementById("modal-genre");if(r.genres&&r.genres.length>0){const l=r.genres.map(c=>c.name),m=window.innerWidth<768?2:3;if(l.length<=m)s.textContent=l.join(", ");else{const c=l.slice(0,m).join(", "),y=l.length-m;s.textContent=`${c} +${y}`,s.title=l.join(", ")}}else s.textContent="—";document.getElementById("modal-overview").textContent=r.overview||"Açıklama yok.";const a=document.getElementById("modal-trailer-wrapper"),i=document.getElementById("modal-trailer-iframe");n&&a&&i?(a.style.display="block",i.src=`https://www.youtube.com/embed/${n.key}?autoplay=1&rel=0`):a&&(a.style.display="none"),u.textContent="Add to my library",u.disabled=!1,u.onclick=()=>D(r),h.classList.add("show"),document.body.style.overflow="hidden"}catch(t){console.error("Modal hatası:",t),alert("Movie details could not be loaded!")}}function D(o){const t=JSON.parse(localStorage.getItem("myMovieLibrary")||"[]");if(t.some(e=>e.id===o.id)){alert("This movie is already in your library!");return}t.push(o),localStorage.setItem("myMovieLibrary",JSON.stringify(t)),alert(`${o.title} added to your library.`),u.textContent="Added",u.disabled=!0}const w=p.TMDB_API_KEY,L=p.TMDB_BASE_URL;function P(o){const t=o/2,e=Math.floor(t),r=t-e>=.5,n=5-e-(r?1:0);let s="";for(let a=0;a<e;a++)s+='<li><svg class="star-svg"><use href="./img/sprite.svg#full-star"></use></svg></li>';r&&(s+='<li><svg class="star-svg"><use href="./img/sprite.svg#half-star"></use></svg></li>');for(let a=0;a<n;a++)s+='<li><svg class="star-svg"><use href="./img/sprite.svg#empty-star"></use></svg></li>';return s}async function q(){try{const o=localStorage.getItem("myMovieLibrary");if(!o)return null;const t=JSON.parse(o);if(!Array.isArray(t)||t.length===0)return null;const e=t[Math.floor(Math.random()*t.length)],r=typeof e=="number"?e:e.id;if(!r)return null;const n=await fetch(`${L}/movie/${r}?api_key=${w}&append_to_response=videos`);return n.ok?await n.json():null}catch(o){return console.error("Kütüphaneden film çekilemedi:",o),null}}function O(o,t=20){const e=o.trim().split(/\s+/);return e.length<=t?o:e.slice(0,t).join(" ")+"..."}async function C(){var n,s;const o=document.getElementById("hero-default"),t=document.getElementById("hero-random-movie");if(!t||t.dataset.heroLoaded==="true")return;let e=null,r=null;try{if(document.querySelector('[data-hero-mode="library"]')&&(e=await q(),e||console.log("Kütüphane boş veya hata → trending film kullanılıyor")),!e){const d=await fetch(`${L}/trending/movie/week?api_key=${w}`);if(!d.ok)throw new Error("API Hatası");const b=await d.json();e=b.results[Math.floor(Math.random()*b.results.length)]}(n=e.videos)!=null&&n.results?r=e.videos.results.find(d=>d.site==="YouTube"&&["Trailer","Teaser","Clip"].includes(d.type)):r=(s=(await(await fetch(`${L}/movie/${e.id}/videos?api_key=${w}`)).json()).results)==null?void 0:s.find(k=>k.site==="YouTube"&&["Trailer","Teaser","Clip"].includes(k.type)),o.style.display="none",t.style.display="flex",t.querySelector(".hero-movie-title").textContent=e.title;const i=t.querySelector(".hero-movie-details"),l=e.overview||"Açıklama yok.";i.textContent=O(l,20),l.split(/\s+/).length>20&&(i.title=l),t.querySelector(".hero-movie-stars").innerHTML=`
      <ul class="card-rating hero-rating">${P(e.vote_average)}</ul>
    `;const f=t.querySelector(".hero-movie-poster-crop"),m=e.backdrop_path?`https://image.tmdb.org/t/p/original${e.backdrop_path}`:e.poster_path?`https://image.tmdb.org/t/p/w1280${e.poster_path}`:"./img/no-poster.jpg";f.style.backgroundImage=`url(${m})`;const c=document.getElementById("trailer-modal"),y=document.getElementById("watch-trailer-btn"),g=c.querySelector(".trailer-content"),_=()=>{r&&(g.innerHTML=`
          <button class="trailer-close-btn" type="button">
            <svg><use href="./img/sprite.svg#close-mobile"></use></svg>
          </button>
          <iframe src="https://www.youtube.com/embed/${r.key}?autoplay=1&rel=0" 
                  allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe>
        `),c.style.display="block"},v=()=>{c.style.display="none",g.innerHTML=`
        <button class="trailer-close-btn" type="button">
          <svg><use href="./img/sprite.svg#close-mobile"></use></svg>
        </button>
        <p class="trailer-info">OOPS...<br>We are very sorry!<br>But we couldn’t find the trailer.</p>
        <img src="./img/Trailer-Error-Mobile.png" srcset="./img/Trailer-Error-Desktop@2x.png 2x" alt="Trailer not found" class="trailer-image">
      `};y.onclick=_,c.querySelector(".trailer-close-btn").onclick=v,c.onclick=d=>d.target===c&&v(),document.addEventListener("keydown",d=>d.key==="Escape"&&c.style.display==="block"&&v()),document.getElementById("more-details-btn").onclick=async()=>{await x(e.id)},t.dataset.heroLoaded="true"}catch(a){console.error("Hero yüklenemedi:",a),o.style.display="block",t.style.display="none"}}function M(){const o=document.getElementById("hero-random-movie"),t=document.getElementById("hero-default");!o||!t||o.dataset.heroLoaded!=="true"&&C().then(()=>{o.dataset.heroLoaded="true"})}const I=new MutationObserver(o=>{o.forEach(t=>{t.addedNodes.forEach(e=>{var r;e.nodeType===1&&(e.id==="hero-random-movie"||(r=e.querySelector)!=null&&r.call(e,"#hero-random-movie"))&&M()})})});document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{I.observe(document.body,{childList:!0,subtree:!0}),M()}):(I.observe(document.body,{childList:!0,subtree:!0}),M());window.setActiveNavLink=function(){setTimeout(()=>{const o=location.pathname.split("/").pop()||"index.html";document.querySelectorAll("a[href]").forEach(e=>{let r=e.getAttribute("href")||"";if(r=r.replace(/^\.?\//,""),r===o||(o==="index.html"||o===""||o==="home.html")&&(r==="home.html"||r==="index.html")){e.classList.add("active");const i=e.closest("li");i&&i.classList.add("active")}else{e.classList.remove("active");const i=e.closest("li");i&&i.classList.remove("active")}})},100)};document.addEventListener("DOMContentLoaded",window.setActiveNavLink);document.addEventListener("load:partial",window.setActiveNavLink);document.addEventListener("DOMContentLoaded",()=>{const o=setInterval(()=>{document.querySelector(".header-nav-link")&&(window.setActiveNavLink(),clearInterval(o))},200)});const T=document.querySelectorAll(".theme-toggle-btn"),S=o=>{document.documentElement.dataset.theme=o,localStorage.setItem("theme",o),document.querySelectorAll(".theme-toggle-btn").forEach(t=>{t.style.transform="scale(0.9)",setTimeout(()=>t.style.transform="",200)}),T.forEach(t=>{var a,i,l,f,m,c,y,g;const e=t.querySelector('[href$="moon"]'),r=t.querySelector('[href$="sun"]'),n=t.querySelector('[href*="moon-circle"]'),s=t.querySelector('[href*="sun-circle"]');o==="light"?((a=e==null?void 0:e.parentElement)==null||a.style.setProperty("display","none"),(i=r==null?void 0:r.parentElement)==null||i.style.removeProperty("display"),(l=n==null?void 0:n.parentElement)==null||l.style.setProperty("display","none"),(f=s==null?void 0:s.parentElement)==null||f.style.removeProperty("display")):((m=e==null?void 0:e.parentElement)==null||m.style.removeProperty("display"),(c=r==null?void 0:r.parentElement)==null||c.style.setProperty("display","none"),(y=n==null?void 0:n.parentElement)==null||y.style.removeProperty("display"),(g=s==null?void 0:s.parentElement)==null||g.style.setProperty("display","none"))})};T.forEach(o=>{o.addEventListener("click",()=>{const e=(document.documentElement.dataset.theme||"dark")==="dark"?"light":"dark";S(e)})});document.addEventListener("DOMContentLoaded",()=>{const o=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches,e=o||(t?"dark":"light");e&&(document.documentElement.dataset.theme=e),S(document.documentElement.dataset.theme||"dark")});export{p as c,x as o};
//# sourceMappingURL=theme-bUx1zVOJ.js.map

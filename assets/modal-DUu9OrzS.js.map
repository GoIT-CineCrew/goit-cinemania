{"version":3,"file":"modal-DUu9OrzS.js","sources":["../../src/config.js","../../src/js/modal.js"],"sourcesContent":["const config = {\n  TMDB_API_KEY: '532c164e7aaa985e6a97f7fc762d2aea',\n  TMDB_BASE_URL: 'https://api.themoviedb.org/3',\n  TMDB_IMAGE_BASE_URL: 'https://image.tmdb.org/t/p',\n};\n\nexport default config;\n","import config from '../config.js';\n\nconsole.log('YENİ MODAL.JS YÜKLENDİ - ' + new Date().toLocaleTimeString());\nlet modal, closeBtn, libraryBtn;\n\n// Modal yüklendi mi diye sürekli kontrol eden fonksiyon\nfunction waitForModal() {\n  return new Promise(resolve => {\n    const check = () => {\n      modal = document.getElementById('movie-modal');\n      closeBtn = document.getElementById('modal-close-btn');\n      libraryBtn = document.getElementById('modal-library-btn');\n\n      if (modal && closeBtn && libraryBtn) {\n        setupModalEvents();\n        resolve();\n      } else {\n        requestAnimationFrame(check); // 60fps'de sürekli kontrol et\n      }\n    };\n    check();\n  });\n}\n\n// Modal event’lerini bir kere kur\nfunction setupModalEvents() {\n  closeBtn.addEventListener('click', closeModal);\n  modal.addEventListener('click', e => {\n    if (e.target.classList.contains('modal-backdrop')) closeModal();\n  });\n}\n\nfunction closeModal() {\n  modal.classList.remove('show');\n  document.body.style.overflow = '';\n  const wrapper = document.getElementById('modal-trailer-wrapper');\n  const iframe = document.getElementById('modal-trailer-iframe');\n  if (wrapper) wrapper.style.display = 'none';\n  if (iframe) iframe.src = '';\n}\n\n// Ana fonksiyon – artık her yerden güvenle çağırılabilir\nexport async function openMovieModal(movieId) {\n  console.log('openMovieModal çağrıldı, ID:', movieId); // ← BU LOG ÇOK ÖNEMLİ\n  await waitForModal(); // modal gelene kadar bekle\n\n  try {\n    const [movieRes, videoRes] = await Promise.all([\n      axios.get(\n        `${config.TMDB_BASE_URL}/movie/${movieId}?api_key=${config.TMDB_API_KEY}`\n      ),\n      axios.get(\n        `${config.TMDB_BASE_URL}/movie/${movieId}/videos?api_key=${config.TMDB_API_KEY}`\n      ),\n    ]);\n\n    const movie = movieRes.data;\n    const trailer = videoRes.data.results.find(\n      v => v.site === 'YouTube' && v.type === 'Trailer'\n    );\n\n    // Artık null olma ihtimali YOK\n    document.getElementById('modal-poster').src = movie.poster_path\n      ? `https://image.tmdb.org/t/p/w500${movie.poster_path}`\n      : './img/no-poster.jpg';\n\n    document.getElementById('modal-title').textContent = movie.title;\n    document.getElementById(\n      'modal-rating'\n    ).textContent = `${movie.vote_average.toFixed(1)} / ${movie.vote_count}`;\n    document.getElementById('modal-popularity').textContent = Math.round(\n      movie.popularity\n    );\n    document.getElementById('modal-release').textContent = formatDate(\n      movie.release_date\n    );\n    document.getElementById('modal-overview').textContent =\n      movie.overview || 'Açıklama yok.';\n\n    // Trailer gösterimi için kullanılan yapı\n    const trailerWrapper = document.getElementById('modal-trailer-wrapper');\n    const iframe = document.getElementById('modal-trailer-iframe');\n    if (trailer && trailerWrapper && iframe) {\n      trailerWrapper.style.display = 'block';\n      iframe.src = `https://www.youtube.com/embed/${trailer.key}?autoplay=1&rel=0`;\n    } else if (trailerWrapper) {\n      trailerWrapper.style.display = 'none';\n    }\n\n    // Kütüphaneye ekle butonu - addToLibrary ile birlikte localStorage içerisine verileri ekleyebildiğimiz bir sistem oluşturuyoruz.\n    libraryBtn.textContent = 'Add to my library';\n    libraryBtn.disabled = false;\n    libraryBtn.onclick = () => addToLibrary(movie);\n\n    modal.classList.add('show'); // flex’i aç\n    document.body.style.overflow = 'hidden';\n  } catch (err) {\n    console.error('Modal hatası:', err);\n    alert('Movie details could not be loaded!');\n  }\n}\n\nfunction formatDate(dateString) {\n  if (!dateString) return '—';\n  const months = [\n    'January',\n    'February',\n    'March',\n    'April',\n    'May',\n    'June',\n    'July',\n    'August',\n    'September',\n    'October',\n    'November',\n    'December',\n  ];\n  const d = new Date(dateString);\n  return `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;\n}\n\n// Add to my library fonksiyonu - LocalStorage içerisine mevcut filmlerin verilerini json oluşturup, oraya ekleyen bir yapı kuruldu.\nfunction addToLibrary(movie) {\n  const library = JSON.parse(localStorage.getItem('myMovieLibrary') || '[]');\n  if (library.some(m => m.id === movie.id)) {\n    alert('This movie is already in your library!');\n    return;\n  }\n  library.push(movie);\n  localStorage.setItem('myMovieLibrary', JSON.stringify(library));\n  alert(`${movie.title} added to your library.`);\n  libraryBtn.textContent = 'Added';\n  libraryBtn.disabled = true;\n}\n"],"names":["config","modal","closeBtn","libraryBtn","waitForModal","resolve","check","setupModalEvents","closeModal","e","wrapper","iframe","openMovieModal","movieId","movieRes","videoRes","movie","trailer","v","formatDate","trailerWrapper","addToLibrary","err","dateString","months","d","library","m"],"mappings":"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"}
import{o as M}from"./theme-Bh1W3b2d.js";const g={},_="aaf24ac7ab7c5211361a71263e777bb9";let v=null;const E=20;let p=1,b=[];const d=document.querySelector(".library-dropdown-filter"),S=d.querySelector(".selected"),c=d.querySelector(".options"),h=document.querySelector(".library-movie-items"),o=document.querySelector(".library-load-button");S.addEventListener("click",()=>{const t=d.classList.toggle("open");c.style.display=t?"block":"none"});document.addEventListener("click",t=>{d.contains(t.target)||(d.classList.remove("open"),c.style.display="none")});async function G(){const t=localStorage.getItem("tmdbGenresIdToName");if(t){Object.assign(g,JSON.parse(t));return}try{const e=await axios.get("https://api.themoviedb.org/3/genre/movie/list",{params:{api_key:_,language:"en-US"}}),n={};e.data.genres.forEach(r=>{n[r.id]=r.name}),Object.assign(g,n),localStorage.setItem("tmdbGenresIdToName",JSON.stringify(n))}catch(e){console.error("Türler yüklenemedi:",e)}}function k(){const t=localStorage.getItem("myMovieLibrary");if(!t)return[];const e=JSON.parse(t),n=new Set;return e.forEach(r=>{let a=[];Array.isArray(r.genre_ids)?a=r.genre_ids:Array.isArray(r.genres)&&(a=r.genres.map(s=>s.id)),a.forEach(s=>{g[s]&&n.add(s)})}),Array.from(n)}function N(){const t=k();c.innerHTML="";const e=document.createElement("div");e.classList.add("option","selected"),e.textContent="All Film",e.dataset.value="",c.appendChild(e),t.forEach(n=>{const r=g[n];if(r){const a=document.createElement("div");a.classList.add("option"),a.textContent=r,a.dataset.value=n,c.appendChild(a)}}),q()}function q(){const t=document.querySelectorAll(".library-dropdown-filter .option");t.forEach(e=>{e.addEventListener("click",()=>{S.childNodes[0].textContent=e.textContent,t.forEach(r=>r.classList.remove("selected")),e.classList.add("selected"),d.classList.remove("open"),c.style.display="none",v=e.dataset.value?Number(e.dataset.value):null,p=1,L(!0)})})}document.addEventListener("DOMContentLoaded",async()=>{await G(),N(),L(!0)});function L(t=!1){let e=JSON.parse(localStorage.getItem("myMovieLibrary"))||[];if(e.length===0){document.querySelector(".library-content").style.display="none",document.querySelector(".library-content-empty").style.display="block",o.style.display="none";return}if(t){p=1;let s=e;v&&(s=e.filter(l=>{let i=[];return Array.isArray(l.genre_ids)?i=l.genre_ids:Array.isArray(l.genres)&&(i=l.genres.map(u=>u.id)),i.includes(v)})),b=s,h.innerHTML="",o.style.display="none"}const n=(p-1)*E,r=n+E,a=b.slice(n,r);if(a.length===0&&t){h.innerHTML="<p class='no-results'>Seçilen türe ait film bulunmamaktadır.</p>",o.style.display="none";return}a.forEach(s=>{const l=s.title||"Unknown",i=s.poster_path?`https://image.tmdb.org/t/p/w300${s.poster_path}`:"./img/placeholder.jpg",u=s.vote_average??"N/A",I=s.release_date?s.release_date.slice(0,4):"N/A";let f=[];Array.isArray(s.genre_ids)?f=s.genre_ids:Array.isArray(s.genres)&&(f=s.genres.map(m=>m.id));const A=f.map(m=>g[m]).filter(Boolean).join(", "),y=document.createElement("li");y.classList.add("library-movie-item"),y.dataset.movieId=s.id,y.style.cursor="pointer",y.innerHTML=`
        <section class="card">
            <img
                class="card-image"
                src="${i}"
                alt="${l}"
                loading="lazy"
            />
            <div class="card-content">
                <h2 class="card-title">${l}</h2>
                <p class="card-info">
                    <span class="card-genre">${A}</span>
                    | <span class="card-year">${I}</span>
                </p>
                <ul class="card-rating">
                    ${w(u)}
                </ul>
            </div>
        </section>
        `,h.appendChild(y)}),b.length>r?o.style.display="block":o.style.display="none"}function w(t,e=!1){const n=t/2,r=Math.floor(n),a=n-r>=.5,s=5-r-(a?1:0);let l="";for(let i=0;i<r;i++)l+='<li><svg class="star-svg"><use href="./img/sprite.svg#full-star"></use></svg></li>';a&&(l+='<li><svg class="star-svg"><use href="./img/sprite.svg#half-star"></use></svg></li>');for(let i=0;i<s;i++)l+='<li><svg class="star-svg"><use href="./img/sprite.svg#empty-star"></use></svg></li>';return l}document.addEventListener("click",t=>{const e=t.target.closest(".library-movie-item");e!=null&&e.dataset.movieId&&M(e.dataset.movieId)});o.addEventListener("click",()=>{p+=1,L(!1)});
//# sourceMappingURL=myLibrary-BSySYW-S.js.map

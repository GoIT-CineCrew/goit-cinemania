{"version":3,"file":"myLibrary-CngSO1A_.js","sources":["../../src/js/library-hero.js","../../src/myLibrary.js"],"sourcesContent":["import config from '../config.js'; // SENİN CONFIG DOSYAN\n\nconst { TMDB_API_KEY, TMDB_BASE_URL } = config;\n\nasync function setLibraryHeroBackground() {\n  const heroElement = document.querySelector('.library-hero-bg');\n  if (!heroElement) {\n    console.log('library-hero-bg bulunamadı');\n    return;\n  }\n\n  try {\n    // 1. Kütüphaneyi al\n    const raw = localStorage.getItem('myMovieLibrary');\n    if (!raw) {\n      console.log('Kütüphane yok – fallback kullanılıyor');\n      return;\n    }\n\n    const library = JSON.parse(raw);\n    if (!Array.isArray(library) || library.length === 0) {\n      console.log('Kütüphane boş – fallback kullanılıyor');\n      return;\n    }\n\n    // 2. Rastgele film seç (sadece ID olabilir)\n    const randomItem = library[Math.floor(Math.random() * library.length)];\n    const movieId = typeof randomItem === 'number' ? randomItem : randomItem.id;\n\n    if (!movieId) {\n      console.log('Geçerli ID yok');\n      return;\n    }\n\n    console.log('Kütüphaneden seçilen film ID:', movieId);\n\n    // 3. SENİN CONFIG’İNLE API’DEN TAM FİLM BİLGİSİNİ ÇEK\n    const res = await fetch(\n      `${TMDB_BASE_URL}/movie/${movieId}?api_key=${TMDB_API_KEY}`\n    );\n\n    if (!res.ok) {\n      console.log('API hatası:', res.status);\n      return;\n    }\n\n    const movie = await res.json();\n\n    // 4. Backdrop varsa → arka plan yap (senin hero.js ile aynı yapı)\n    const backdropPath = movie?.backdrop_path;\n    if (backdropPath) {\n      const imageUrl = `https://image.tmdb.org/t/p/w1920${backdropPath}`;\n      heroElement.style.backgroundImage = `url('${imageUrl}')`;\n      heroElement.style.backgroundSize = 'cover';\n      heroElement.style.backgroundPosition = 'center';\n      heroElement.style.backgroundRepeat = 'no-repeat';\n      console.log('Library hero yüklendi:', movie.title);\n    } else {\n      console.log('Backdrop yok:', movie.title);\n    }\n  } catch (error) {\n    console.error('Library hero görseli yüklenemedi:', error);\n  }\n}\n\n// HEMEN ÇALIŞTIR (partial olduğu için DOMContentLoaded beklemeye gerek yok)\nsetLibraryHeroBackground();\n","// myLibrary.js - SENİN YORUM SATIRLARINLA, TAMAMEN SENİN TARZINDA DÜZENLENMİŞ\n\nimport { openMovieModal } from './js/modal.js';\n\nconst genreMap = {};\nconst API_KEY = 'aaf24ac7ab7c5211361a71263e777bb9';\nlet selectedGenre = null; // Seçilen tür ID'si (Number veya null)\n\n// Dropdown\nconst selectBox = document.querySelector('.library-dropdown-filter');\nconst selected = selectBox.querySelector('.selected');\nconst optionsContainer = selectBox.querySelector('.options');\n\n// Dropdown aç/kapa\nselected.addEventListener('click', () => {\n    const isOpen = selectBox.classList.toggle('open');\n    optionsContainer.style.display = isOpen ? 'block' : 'none';\n});\n\n// Sayfa dışına tıklayınca dropdown kapanır\ndocument.addEventListener('click', e => {\n    if (!selectBox.contains(e.target)) {\n        selectBox.classList.remove('open');\n        optionsContainer.style.display = 'none';\n    }\n});\n\n// TMDB apisinden genre çekme ve mapleme(genreMap)\nasync function loadGenres() {\n    // LocalStorage'ı ID -> Name eşleşmesi için kontrol et (Renderlama için gerekli)\n    const cachedGenresJson = localStorage.getItem('tmdbGenresIdToName');\n   \n    if (cachedGenresJson) {\n        Object.assign(genreMap, JSON.parse(cachedGenresJson));\n        return;\n    }\n   \n    // Yoksa API'den çek\n    try {\n        const response = await axios.get(`https://api.themoviedb.org/3/genre/movie/list`, {\n            params: { api_key: API_KEY, language: \"en-US\" }\n        });\n       \n        const newGenreMap = {};\n        response.data.genres.forEach(g => {\n            newGenreMap[g.id] = g.name; // ID -> İSİM olarak kaydet\n        });\n       \n        Object.assign(genreMap, newGenreMap);\n        localStorage.setItem('tmdbGenresIdToName', JSON.stringify(newGenreMap));\n       \n    } catch (err) {\n        console.error(\"Türler yüklenemedi:\", err);\n    }\n}\n\n// Kütüphanedeki filmlerden benzersiz tür ID'lerini toplar ve Dinamik dropdown oluşturur\nfunction getGenresFromLibrary() {\n    const libraryJson = localStorage.getItem('myMovieLibrary');\n    if (!libraryJson) return [];\n    const libraryMovies = JSON.parse(libraryJson);\n    const uniqueGenreIds = new Set();\n    libraryMovies.forEach(movie => {\n        let genreIds = [];\n       \n        if (Array.isArray(movie.genre_ids)) {\n            genreIds = movie.genre_ids;\n        } else if (Array.isArray(movie.genres)) {\n            genreIds = movie.genres.map(g => g.id);\n        }\n       \n        genreIds.forEach(id => {\n            if (genreMap[id]) { // Sadece elimizdeki ID'leri toplarız\n                uniqueGenreIds.add(id);\n            }\n        });\n    });\n   \n    return Array.from(uniqueGenreIds);\n}\n\n// Kütüphane türlerini kullanarak dropdown'ı oluşturur\nfunction renderLibraryGenreDropdown() {\n    const requiredGenreIds = getGenresFromLibrary();\n   \n    optionsContainer.innerHTML = ''; // Önceki seçenekleri temizle\n    // 1. Varsayılan (Tümü) seçeneğini ekle\n    const defaultOption = document.createElement('div');\n    defaultOption.classList.add('option', 'selected');\n    defaultOption.textContent = 'All Genres';\n    defaultOption.dataset.value = ''; // Filtrelememek için boş değer\n    optionsContainer.appendChild(defaultOption);\n    // 2. Dinamik olarak türleri ekle\n    requiredGenreIds.forEach(id => {\n        const genreName = genreMap[id];\n       \n        if (genreName) {\n            const option = document.createElement('div');\n            option.classList.add('option');\n            option.textContent = genreName;\n            option.dataset.value = id; // data-value olarak ID'yi sakla\n            optionsContainer.appendChild(option);\n        }\n    });\n    // 3. Olay dinleyicilerini yeniden bağla\n    updateDropdownListeners();\n}\n\n// Yeni butonlara olay dinleyicisi ekler\nfunction updateDropdownListeners() {\n    const optionsList = document.querySelectorAll('.library-dropdown-filter .option');\n   \n    optionsList.forEach(option => {\n        option.addEventListener('click', () => {\n            selected.childNodes[0].textContent = option.textContent;\n            optionsList.forEach(o => o.classList.remove('selected'));\n            option.classList.add('selected');\n            selectBox.classList.remove('open');\n            optionsContainer.style.display = 'none';\n            // Seçilen tür ID'sini al ve number'a çevir (yoksa null)\n            const genreId = option.dataset.value ? Number(option.dataset.value) : null;\n            selectedGenre = genreId;\n           \n            // Kütüphaneyi filtreleyerek yeniden yükle\n            loadLibrary();\n        });\n    });\n}\n\n// myLibrary'i localden çekme\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\n    await loadGenres(); // Tüm ID->Name eşleşmelerini yükle\n    renderLibraryGenreDropdown(); // Kütüphanedeki filmlerin türlerine göre dropdown'ı oluştur\n    loadLibrary(); // Kütüphaneyi varsayılan olarak yükle\n});\n\n// filmlerin genlereli gelmekte ve genrelere göre filtreleme\nfunction loadLibrary() {\n    const listEl = document.querySelector(\".library-movie-items\");\n    let library = JSON.parse(localStorage.getItem(\"myMovieLibrary\")) || [];\n    if (library.length === 0) {\n        document.querySelector(\".library-content\").style.display = \"none\";\n        document.querySelector(\".library-content-empty\").style.display = \"block\";\n        return;\n    }\n    // Seçilen türe göre filtrele\n    let filteredLibrary = library;\n    if (selectedGenre) {\n        filteredLibrary = library.filter(movie => {\n            let movieGenreIds = [];\n           \n            if (Array.isArray(movie.genre_ids)) {\n                movieGenreIds = movie.genre_ids;\n            } else if (Array.isArray(movie.genres)) {\n                movieGenreIds = movie.genres.map(g => g.id);\n            }\n           \n            return movieGenreIds.includes(selectedGenre);\n        });\n    }\n    listEl.innerHTML = \"\";\n   \n    if (filteredLibrary.length === 0) {\n        listEl.innerHTML = \"<p class='no-results'>Seçilen türe ait film bulunmamaktadır.</p>\";\n        return;\n    }\n    filteredLibrary.forEach(movie => {\n        const title = movie.title || \"Unknown\";\n       \n        // TMDB apide resim yolu\n        const poster = movie.poster_path\n            ? `https://image.tmdb.org/t/p/w300${movie.poster_path}`\n            : \"./img/placeholder.jpg\";\n           \n        const rating = movie.vote_average ?? \"N/A\";\n       \n        // YIL BİLGİSİNİ ÇEKME\n        const year = movie.release_date ? movie.release_date.slice(0, 4) : \"N/A\";\n        // --- DÜZELTME: Genre isimleri oluşturma (Sadece filme ait ID'leri kullan) ---\n        let movieGenreIds = [];\n        if (Array.isArray(movie.genre_ids)) {\n            movieGenreIds = movie.genre_ids;\n        } else if (Array.isArray(movie.genres)) {\n            movieGenreIds = movie.genres.map(g => g.id);\n        }\n       \n        // Sadece bu filme ait ID'leri genreMap ile isme çevirir\n        const genres = movieGenreIds.map(id => genreMap[id]).filter(Boolean).join(\", \");\n        const li = document.createElement(\"li\");\n        li.classList.add(\"library-movie-item\");\n        li.dataset.movieId = movie.id;           // MODAL İÇİN GEREKLİ\n        li.style.cursor = \"pointer\";             // Kullanıcıya tıklanabilir olduğunu göster\n\n        li.innerHTML = `\n            <section class=\"card\">\n                <img\n                    class=\"card-image\"\n                    src=\"${poster}\"\n                    alt=\"${title}\"\n                    loading=\"lazy\"\n                />\n                <div class=\"card-content\">\n                    <h2 class=\"card-title\">${title}</h2>\n                    <p class=\"card-info\">\n                        <span class=\"card-genre\">${genres}</span>\n                       \n                        | <span class=\"card-year\">${year}</span>\n                       \n                    </p>\n                    <ul class=\"card-rating\">\n                        ${createStarRating(rating)}\n                    </ul>\n                </div>\n            </section>\n        `;\n        listEl.appendChild(li);\n    });\n}\n\nfunction createStarRating(vote_average) {\n    const ratingOutOfFive = vote_average / 2;\n    const fullStars = Math.floor(ratingOutOfFive);\n    const halfStar = ratingOutOfFive % 1 >= 0.5 ? 1 : 0;\n    const emptyStars = 5 - fullStars - halfStar;\n    let starsHTML = \"\";\n    for (let i = 0; i < fullStars; i++) {\n        starsHTML += `<li><svg width=\"14\" height=\"14\"><use href=\"./img/sprite.svg#full-star\"></use></svg></li>`;\n    }\n    if (halfStar) {\n        starsHTML += `<li><svg width=\"14\" height=\"14\"><use href=\"./img/sprite.svg#half-star\"></use></svg></li>`;\n    }\n    for (let i = 0; i < emptyStars; i++) {\n        starsHTML += `<li><svg width=\"14\" height=\"14\"><use href=\"./img/sprite.svg#empty-star\"></use></svg></li>`;\n    }\n    return starsHTML;\n}\n\n// Kart tıklama - MODAL AÇILMASI İÇİN EK\ndocument.addEventListener('click', e => {\n    const card = e.target.closest('.library-movie-item');\n    if (card?.dataset.movieId) {\n        openMovieModal(card.dataset.movieId);\n    }\n});"],"names":["TMDB_API_KEY","TMDB_BASE_URL","config","setLibraryHeroBackground","heroElement","raw","library","randomItem","movieId","res","movie","backdropPath","imageUrl","error","genreMap","API_KEY","selectedGenre","selectBox","selected","optionsContainer","isOpen","e","loadGenres","cachedGenresJson","response","newGenreMap","g","err","getGenresFromLibrary","libraryJson","libraryMovies","uniqueGenreIds","genreIds","id","renderLibraryGenreDropdown","requiredGenreIds","defaultOption","genreName","option","updateDropdownListeners","optionsList","o","loadLibrary","listEl","filteredLibrary","movieGenreIds","title","poster","rating","year","genres","li","createStarRating","vote_average","ratingOutOfFive","fullStars","halfStar","emptyStars","starsHTML","i","card","openMovieModal"],"mappings":"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"}
import{o as S,c as g}from"./header-Dq3ZsvbK.js";const M=g.TMDB_API_KEY,$=g.TMDB_BASE_URL;async function D(){var t;try{let h=function(i){const y=i/2,B=Math.floor(y),I=i%2>=1,L=5-B-(I?1:0);let b="";for(let f=0;f<B;f++)b+='<li><svg width="16" height="16"><use href="./img/sprite.svg#full-star"></use></svg></li>';I&&(b+='<li><svg width="16" height="16"><use href="./img/sprite.svg#half-star"></use></svg></li>');for(let f=0;f<L;f++)b+='<li><svg width="16" height="16"><use href="./img/sprite.svg#empty-star"></use></svg></li>';return b};const o=await fetch(`${$}/trending/movie/week?api_key=${M}`);if(!o.ok)throw new Error(`API Hatası: ${o.status} ${o.statusText}`);const e=(await o.json()).results;if(!e||e.length===0)throw new Error("Film gelmedi");const r=e[Math.floor(Math.random()*e.length)],u=(t=(await(await fetch(`${$}/movie/${r.id}/videos?api_key=${M}`)).json()).results)==null?void 0:t.find(i=>i.site==="YouTube"&&(i.type==="Trailer"||i.type==="Teaser"||i.type==="Clip"));document.getElementById("hero-default").style.display="none";const l=document.getElementById("hero-random-movie");l.style.display="flex",r.backdrop_path&&(l.style.backgroundImage=`url[](https://image.tmdb.org/t/p/original${r.backdrop_path})`),l.querySelector(".hero-movie-title").textContent=r.title,l.querySelector(".hero-movie-details").textContent=r.overview||"Açıklama yok.";const w=document.getElementById("hero-movie-poster");w.src=r.poster_path?`https://image.tmdb.org/t/p/w500${r.poster_path}`:"https://via.placeholder.com/500x750?text=No+Image";const E=l.querySelector(".hero-movie-stars");E.innerHTML=`
  <ul class="card-rating hero-rating">
    ${h(r.vote_average)}
  </ul>
`;const a=document.getElementById("trailer-modal"),c=document.getElementById("watch-trailer-btn"),m=a.querySelector(".trailer-close-btn"),_=a.querySelector(".trailer-content"),k=()=>{u&&(_.innerHTML=`
      <button class="trailer-close-btn" type="button">
        <svg><use href="./img/sprite.svg#close-mobile"></use></svg>
      </button>
      <iframe 
        src="https://www.youtube.com/embed/${u.key}?autoplay=1&rel=0&modestbranding=1"
        frameborder="0"
        allow="autoplay; encrypted-media; picture-in-picture"
        allowfullscreen
        style="position:absolute; top:0; left:0; width:100%; height:100%;">
      </iframe>
    `),a.style.display="block"},p=()=>{a.style.display="none",_.innerHTML=`
    <button class="trailer-close-btn" type="button">
      <svg><use href="./img/sprite.svg#close-mobile"></use></svg>
    </button>
    <p class="trailer-info">
      OOPS... <br />
      We are very sorry! <br />
      But we couldn’t find the trailer.
    </p>
    <img 
      src="./img/Trailer-Error-Mobile.png" 
      srcset="./img/Trailer-Error-Desktop@2x.png 2x" 
      alt="Trailer not found" class="trailer-image"
    >
  `};c.onclick=k,m.onclick=p,a.addEventListener("click",i=>{i.target===a&&p()}),document.addEventListener("keydown",i=>{i.key==="Escape"&&a.style.display==="block"&&p()}),c&&u?(c.style.cursor="pointer",c.disabled=!1,c.onclick=k):c&&(c.disabled=!0,c.style.cursor="not-allowed",c.title="Bu film için fragman bulunamadı"),m&&(m.onclick=p),a.addEventListener("click",i=>{i.target===a&&p()}),document.addEventListener("keydown",i=>{i.key==="Escape"&&a.style.display==="flex"&&p()}),document.getElementById("more-details-btn").onclick=()=>{if(!(r!=null&&r.id))return;const i=document.getElementById("modal-trailer-wrapper"),y=document.getElementById("modal-trailer-iframe");i&&(i.style.display="none"),y&&(y.src=""),S(r.id),setTimeout(()=>{i&&(i.style.display="none"),y&&(y.src="")},100)}}catch(o){console.error("Hero yüklenemedi:",o),document.getElementById("hero-default").style.display="block",document.getElementById("hero-random-movie").style.display="none"}}document.addEventListener("DOMContentLoaded",D);let v={};const x=g.TMDB_API_KEY,A=g.TMDB_BASE_URL,C=g.TMDB_IMAGE_BASE_URL;async function R(){if(!(Object.keys(v).length>0))try{(await axios.get(`${A}/genre/movie/list?api_key=${x}`)).data.genres.forEach(o=>{v[o.id]=o.name}),console.log("Genres loaded:",v)}catch(t){console.error("Genres couldn't loaded:",t)}}async function P(){try{return(await axios.get(`${A}/trending/movie/week?api_key=${x}`)).data.results}catch(t){return console.error("API hatası:",t),[]}}function q(t){const o=t/2,s=Math.floor(o),e=o-s>=.5?1:0,r=5-s-e;let n="";for(let d=0;d<s;d++)n+=`<li>
        <svg width="14" height="14">
            <use href="./img/sprite.svg#full-star"></use>
        </svg>
    </li>`;e&&(n+='<li><svg width="14" height="14"><use href="./img/sprite.svg#half-star"></use></svg></li>');for(let d=0;d<r;d++)n+='<li><svg width="14" height="14"><use href="./img/sprite.svg#empty-star"></use></svg></li>';return n}async function O(){console.log("Anasayfa yüklendi, API'den veri çekiliyor..."),await R();const t=await P();if(console.log("Movies list"+JSON.stringify(t.map(e=>e.title))),await U(),t.length===0)return;const o=t.slice(0,3),s=document.querySelectorAll(".home-movie-item");o.forEach((e,r)=>{const n=s[r];if(!n)return;const d=n.querySelector(".card-title");d&&(d.textContent=e.title||e.name);const u=e.release_date?e.release_date.split("-")[0]:"—",l=n.querySelector(".card-year");l&&(l.textContent=u);const w=e.poster_path?`${C}/w342${e.poster_path}`:"./img/no-poster.jpg",h=n.querySelector(".card-image");h&&(h.src=w,h.alt=`${e.title} poster`);const E=e.genre_ids.slice(0,2).map(m=>v[m]||"Bilinmiyor").join(", "),a=n.querySelector(".card-genre");a&&(a.textContent=E||"No genres");const c=n.querySelector(".card-rating");c&&(c.innerHTML=q(e.vote_average)),n.style.cursor="pointer",n.addEventListener("click",m=>{m.preventDefault(),m.stopPropagation(),console.log("Karta tıklandı, ID:",e.id),S(e.id)})}),console.log("3 kart başarıyla dolduruldu!")}async function U(){try{const t=await axios.get(`${g.TMDB_BASE_URL}/movie/upcoming?api_key=${g.TMDB_API_KEY}&page=1`),o=new Date().toISOString().split("T")[0],s=t.data.results.filter(l=>l.release_date>=o);if(s.length===0){console.log("There are no upcoming movies this month!");return}const e=s[Math.floor(Math.random()*s.length)],r=e.poster_path||"",n=document.getElementById("upcoming-poster");r?(n.srcset=`
    https://image.tmdb.org/t/p/w342${r} 342w,
    https://image.tmdb.org/t/p/w500${r} 500w,
    https://image.tmdb.org/t/p/w780${r} 780w,
    https://image.tmdb.org/t/p/original${r} 1280w
  `,n.sizes="(max-width: 767px) 90vw, (max-width: 1279px) 704px, 805px",n.src=`https://image.tmdb.org/t/p/w780${r}`,n.alt=`${e.title} poster`):(n.src="./img/no-poster.jpg",n.removeAttribute("srcset"),n.removeAttribute("sizes")),document.getElementById("upcoming-title").textContent=e.title,document.getElementById("upcoming-release").textContent=e.release_date?H(e.release_date):"—",document.getElementById("upcoming-vote").textContent=e.vote_average.toFixed(1),document.getElementById("upcoming-votes").textContent=e.vote_count,document.getElementById("upcoming-popularity").textContent=Math.round(e.popularity);const d=e.genre_ids.slice(0,2).map(l=>v[l]||"Bilinmiyor").join(", ");document.getElementById("upcoming-genre").textContent=d,console.log("Film Açıklaması"+e.overview),document.getElementById("upcoming-overview-content").querySelector("p").textContent=e.overview||"Movie overview couldn't find!",console.log("Upcoming movie yüklendi:",e.title);const u=document.getElementById("upcoming-library-btn");u.dataset.movieId=e.id}catch(t){console.error("Upcoming movie yüklenemedi",t)}}function H(t){const o=["January","February","March","April","May","June","July","August","September","October","November","December"],s=new Date(t);return`${s.getDate()} ${o[s.getMonth()]} ${s.getFullYear()}`}const T="myMovieLibrary";function Y(){return JSON.parse(localStorage.getItem(T))||[]}function K(t){const o=Y();o.find(s=>s.id===t.id)?alert("This movie is already in your library!"):(o.push(t),localStorage.setItem(T,JSON.stringify(o)),alert(`${t.title} added to your library.`))}document.addEventListener("click",async function(t){if(t.target.id==="upcoming-library-btn"||t.target.classList.contains("card-library-btn")){const o=t.target.dataset.movieId;if(!o)return;try{const s=await axios.get(`${g.TMDB_BASE_URL}/movie/${o}?api_key=${g.TMDB_API_KEY}`);K(s.data),t.target.textContent="Remove from my library",t.target.disabled=!0}catch{alert("An error occurred while adding the movie.")}}});document.addEventListener("DOMContentLoaded",O);
//# sourceMappingURL=home-Dkcqqofq.js.map

import{c as i}from"./hero-DoyYEIlO.js";console.log("YENİ MODAL.JS YÜKLENDİ - "+new Date().toLocaleTimeString());let d,y,s;function w(){return new Promise(e=>{const o=()=>{d=document.getElementById("movie-modal"),y=document.getElementById("modal-close-btn"),s=document.getElementById("modal-library-btn"),d&&y&&s?(I(),e()):requestAnimationFrame(o)};o()})}function I(){y.addEventListener("click",v),d.addEventListener("click",e=>{e.target.classList.contains("modal-backdrop")&&v()})}function v(){d.classList.remove("show"),document.body.style.overflow="";const e=document.getElementById("modal-trailer-wrapper"),o=document.getElementById("modal-trailer-iframe");e&&(e.style.display="none"),o&&(o.src="")}async function $(e){console.log("openMovieModal çağrıldı, ID:",e),await w();try{const[o,n]=await Promise.all([axios.get(`${i.TMDB_BASE_URL}/movie/${e}?api_key=${i.TMDB_API_KEY}`),axios.get(`${i.TMDB_BASE_URL}/movie/${e}/videos?api_key=${i.TMDB_API_KEY}`)]),t=o.data,l=n.data.results.find(m=>m.site==="YouTube"&&m.type==="Trailer");document.getElementById("modal-poster").src=t.poster_path?`https://image.tmdb.org/t/p/w500${t.poster_path}`:"./img/no-poster.jpg",document.getElementById("modal-title").textContent=t.title,document.getElementById("modal-rating").textContent=`${t.vote_average.toFixed(1)} / ${t.vote_count}`,document.getElementById("modal-popularity").textContent=Math.round(t.popularity),document.getElementById("modal-release").textContent=A(t.release_date),document.getElementById("modal-overview").textContent=t.overview||"Açıklama yok.";const r=document.getElementById("modal-trailer-wrapper"),a=document.getElementById("modal-trailer-iframe");l&&r&&a?(r.style.display="block",a.src=`https://www.youtube.com/embed/${l.key}?autoplay=1&rel=0`):r&&(r.style.display="none"),s.textContent="Add to my library",s.disabled=!1,s.onclick=()=>S(t),d.classList.add("show"),document.body.style.overflow="hidden"}catch(o){console.error("Modal hatası:",o),alert("Movie details could not be loaded!")}}function A(e){if(!e)return"—";const o=["January","February","March","April","May","June","July","August","September","October","November","December"],n=new Date(e);return`${n.getDate()} ${o[n.getMonth()]} ${n.getFullYear()}`}function S(e){const o=JSON.parse(localStorage.getItem("myMovieLibrary")||"[]");if(o.some(n=>n.id===e.id)){alert("This movie is already in your library!");return}o.push(e),localStorage.setItem("myMovieLibrary",JSON.stringify(o)),alert(`${e.title} added to your library.`),s.textContent="Added",s.disabled=!0}let c={};const E=i.TMDB_API_KEY,_=i.TMDB_BASE_URL,k=i.TMDB_IMAGE_BASE_URL;async function L(){if(!(Object.keys(c).length>0))try{(await axios.get(`${_}/genre/movie/list?api_key=${E}`)).data.genres.forEach(o=>{c[o.id]=o.name}),console.log("Genres loaded:",c)}catch(e){console.error("Genres couldn't loaded:",e)}}async function D(){try{return(await axios.get(`${_}/trending/movie/week?api_key=${E}`)).data.results}catch(e){return console.error("API hatası:",e),[]}}function x(e){const o=e/2,n=Math.floor(o),t=o-n>=.5?1:0,l=5-n-t;let r="";for(let a=0;a<n;a++)r+=`<li>
        <svg width="14" height="14">
            <use href="./img/sprite.svg#full-star"></use>
        </svg>
    </li>`;t&&(r+='<li><svg width="14" height="14"><use href="./img/sprite.svg#half-star"></use></svg></li>');for(let a=0;a<l;a++)r+='<li><svg width="14" height="14"><use href="./img/sprite.svg#empty-star"></use></svg></li>';return r}async function T(){console.log("Anasayfa yüklendi, API'den veri çekiliyor..."),await L();const e=await D();if(console.log("Movies list"+JSON.stringify(e.map(t=>t.title))),await C(),e.length===0)return;const o=e.slice(0,3),n=document.querySelectorAll(".home-movie-item");o.forEach((t,l)=>{const r=n[l];if(!r)return;const a=r.querySelector(".card-title");a&&(a.textContent=t.title||t.name);const m=t.release_date?t.release_date.split("-")[0]:"—",p=r.querySelector(".card-year");p&&(p.textContent=m);const B=t.poster_path?`${k}/w342${t.poster_path}`:"./img/no-poster.jpg",g=r.querySelector(".card-image");g&&(g.src=B,g.alt=`${t.title} poster`);const M=t.genre_ids.slice(0,2).map(u=>c[u]||"Bilinmiyor").join(", "),f=r.querySelector(".card-genre");f&&(f.textContent=M||"No genres");const h=r.querySelector(".card-rating");h&&(h.innerHTML=x(t.vote_average)),r.style.cursor="pointer",r.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),console.log("Karta tıklandı, ID:",t.id),$(t.id)})}),console.log("3 kart başarıyla dolduruldu!")}async function C(){try{const e=await axios.get(`${i.TMDB_BASE_URL}/movie/upcoming?api_key=${i.TMDB_API_KEY}&page=1`),o=new Date().toISOString().split("T")[0],n=e.data.results.filter(a=>a.release_date>=o);if(n.length===0){console.log("There are no upcoming movies this month!");return}const t=n[Math.floor(Math.random()*n.length)];document.getElementById("upcoming-poster").src=t.poster_path?`https://image.tmdb.org/t/p/w500${t.poster_path}`:"./img/no-poster.jpg",document.getElementById("upcoming-title").textContent=t.title,document.getElementById("upcoming-release").textContent=t.release_date?Y(t.release_date):"—",document.getElementById("upcoming-vote").textContent=t.vote_average.toFixed(1),document.getElementById("upcoming-votes").textContent=t.vote_count,document.getElementById("upcoming-popularity").textContent=Math.round(t.popularity);const l=t.genre_ids.slice(0,2).map(a=>c[a]||"Bilinmiyor").join(", ");document.getElementById("upcoming-genre").textContent=l,console.log("Film Açıklaması"+t.overview),document.getElementById("upcoming-overview-content").querySelector("p").textContent=t.overview||"Movie overview couldn't find!",console.log("Upcoming movie yüklendi:",t.title);const r=document.getElementById("upcoming-library-btn");r.dataset.movieId=t.id}catch(e){console.error("Upcoming movie yüklenemedi",e)}}function Y(e){const o=["January","February","March","April","May","June","July","August","September","October","November","December"],n=new Date(e);return`${n.getDate()} ${o[n.getMonth()]} ${n.getFullYear()}`}const b="myMovieLibrary";function J(){return JSON.parse(localStorage.getItem(b))||[]}function P(e){const o=J();o.find(n=>n.id===e.id)?alert("This movie is already in your library!"):(o.push(e),localStorage.setItem(b,JSON.stringify(o)),alert(`${e.title} added to your library.`))}document.addEventListener("click",async function(e){if(e.target.id==="upcoming-library-btn"||e.target.classList.contains("card-library-btn")){const o=e.target.dataset.movieId;if(!o)return;try{const n=await axios.get(`${i.TMDB_BASE_URL}/movie/${o}?api_key=${i.TMDB_API_KEY}`);P(n.data),e.target.textContent="Remove from my library",e.target.disabled=!0}catch{alert("An error occurred while adding the movie.")}}});document.addEventListener("DOMContentLoaded",T);
//# sourceMappingURL=main-C5d2ZE6N.js.map
